2026-02-20 03:26:30.125 | INFO     | __main__:load_and_prepare_datasets:143 - Skipping clinical_patient_triage_nl (N=31, too small for k-NN)
2026-02-20 03:26:30.125 | WARNING  | __main__:load_and_prepare_datasets:146 - Duplicate dataset 'medical_abstracts' — keeping first occurrence
2026-02-20 03:26:30.125 | INFO     | __main__:load_and_prepare_datasets:175 - medical_abstracts: using all 3
2026-02-20 03:26:30.125 | INFO     | __main__:load_and_prepare_datasets:175 - mimic_iv_ed_demo: using all 3
2026-02-20 03:26:30.125 | INFO     | __main__:load_and_prepare_datasets:175 - ohsumed_single: using all 3
2026-02-20 03:26:30.125 | INFO     | __main__:load_and_prepare_datasets:175 - mental_health_conditions: using all 3
2026-02-20 03:26:30.125 | INFO     | __main__:load_and_prepare_datasets:175 - medical_transcriptions: using all 3
2026-02-20 03:26:30.125 | INFO     | __main__:main:1075 - Loaded 5 datasets: ['medical_abstracts', 'mimic_iv_ed_demo', 'ohsumed_single', 'mental_health_conditions', 'medical_transcriptions']
2026-02-20 03:26:39.374 | INFO     | __main__:main:1087 - === [1/5] Processing medical_abstracts (N=3) ===
2026-02-20 03:26:39.396 | INFO     | __main__:main:1092 -   Classes (3): ['Digestive_system_diseases', 'General_pathological_conditions', 'Neoplasms']
2026-02-20 03:26:39.396 | INFO     | __main__:main:1097 -   Building TF-IDF features...
2026-02-20 03:26:39.399 | DEBUG    | __main__:build_tfidf_features:195 - TF-IDF shape: (3, 6)
2026-02-20 03:26:39.399 | INFO     | __main__:main:1100 -   Building sentence embeddings...
2026-02-20 03:26:41.881 | DEBUG    | __main__:main:1102 -   Embeddings shape: (3, 384)
2026-02-20 03:26:41.881 | INFO     | __main__:main:1127 -   Building char n-gram features (fallback for LLM)...
2026-02-20 03:26:42.047 | DEBUG    | __main__:build_doc2vec_features:376 - Char n-gram features shape: (3, 100)
2026-02-20 03:26:42.047 | INFO     | __main__:main:1151 -   Working subset size: 3
2026-02-20 03:26:42.048 | INFO     | __main__:main:1156 -   Computing CRND scores...
2026-02-20 03:26:42.053 | INFO     | __main__:main:1159 -   Computing label entropy (kDN per space)...
2026-02-20 03:26:42.057 | INFO     | __main__:main:1165 -   Computing cleanlab scores...
2026-02-20 03:26:42.059 | WARNING  | __main__:compute_cleanlab_scores:474 - cross_val_predict failed — returning uniform scores
2026-02-20 03:26:42.062 | WARNING  | __main__:compute_cleanlab_scores:474 - cross_val_predict failed — returning uniform scores
2026-02-20 03:26:42.062 | INFO     | __main__:main:1170 -   Computing WANN-adapted scores...
2026-02-20 03:26:42.064 | INFO     | __main__:main:1173 -   Computing cartography proxy scores...
2026-02-20 03:26:42.070 | WARNING  | __main__:compute_cartography_proxy:552 - Cartography CV round 0 failed
2026-02-20 03:26:42.071 | WARNING  | __main__:compute_cartography_proxy:552 - Cartography CV round 1 failed
2026-02-20 03:26:42.071 | WARNING  | __main__:compute_cartography_proxy:552 - Cartography CV round 2 failed
2026-02-20 03:26:42.072 | WARNING  | __main__:compute_cartography_proxy:552 - Cartography CV round 3 failed
2026-02-20 03:26:42.073 | WARNING  | __main__:compute_cartography_proxy:552 - Cartography CV round 4 failed
2026-02-20 03:26:42.073 | INFO     | __main__:main:1176 -   Computing hybrid scores (H1-H4)...
2026-02-20 03:26:42.073 | INFO     | __main__:main:1182 -   Running noise injection evaluation...
2026-02-20 03:26:42.076 | INFO     | __main__:main:1224 -   Running significance tests...
2026-02-20 03:26:42.077 | INFO     | __main__:main:1242 -   Running quadrant analysis...
2026-02-20 03:26:42.077 | INFO     | __main__:main:1254 -   Computing Schoener's D niche overlap...
2026-02-20 03:26:42.078 | INFO     | __main__:main:1262 -   Per-class CRND analysis...
2026-02-20 03:26:42.079 | INFO     | __main__:main:1268 -   Testing niche overlap → classifier prediction...
2026-02-20 03:26:42.082 | INFO     | __main__:main:1309 -   Building per-instance output...
2026-02-20 03:26:42.082 | INFO     | __main__:main:1376 -   medical_abstracts completed in 3s (3 examples)
2026-02-20 03:26:42.237 | INFO     | __main__:main:1087 - === [2/5] Processing mimic_iv_ed_demo (N=3) ===
2026-02-20 03:26:42.238 | INFO     | __main__:main:1092 -   Classes (1): ['ESI-2']
2026-02-20 03:26:42.238 | INFO     | __main__:main:1097 -   Building TF-IDF features...
2026-02-20 03:26:42.240 | DEBUG    | __main__:build_tfidf_features:195 - TF-IDF shape: (3, 4)
2026-02-20 03:26:42.240 | INFO     | __main__:main:1100 -   Building sentence embeddings...
2026-02-20 03:26:43.883 | DEBUG    | __main__:main:1102 -   Embeddings shape: (3, 384)
2026-02-20 03:26:43.883 | INFO     | __main__:main:1127 -   Building char n-gram features (fallback for LLM)...
2026-02-20 03:26:43.891 | DEBUG    | __main__:build_doc2vec_features:376 - Char n-gram features shape: (3, 11)
2026-02-20 03:26:43.891 | INFO     | __main__:main:1151 -   Working subset size: 3
2026-02-20 03:26:43.892 | INFO     | __main__:main:1156 -   Computing CRND scores...
2026-02-20 03:26:43.897 | INFO     | __main__:main:1159 -   Computing label entropy (kDN per space)...
2026-02-20 03:26:43.900 | INFO     | __main__:main:1165 -   Computing cleanlab scores...
2026-02-20 03:26:43.902 | WARNING  | __main__:compute_cleanlab_scores:474 - cross_val_predict failed — returning uniform scores
2026-02-20 03:26:43.904 | WARNING  | __main__:compute_cleanlab_scores:474 - cross_val_predict failed — returning uniform scores
2026-02-20 03:26:43.904 | INFO     | __main__:main:1170 -   Computing WANN-adapted scores...
2026-02-20 03:26:43.905 | INFO     | __main__:main:1173 -   Computing cartography proxy scores...
2026-02-20 03:26:43.908 | WARNING  | __main__:compute_cartography_proxy:552 - Cartography CV round 0 failed
2026-02-20 03:26:43.910 | WARNING  | __main__:compute_cartography_proxy:552 - Cartography CV round 1 failed
2026-02-20 03:26:43.916 | WARNING  | __main__:compute_cartography_proxy:552 - Cartography CV round 2 failed
2026-02-20 03:26:43.919 | WARNING  | __main__:compute_cartography_proxy:552 - Cartography CV round 3 failed
2026-02-20 03:26:43.923 | WARNING  | __main__:compute_cartography_proxy:552 - Cartography CV round 4 failed
2026-02-20 03:26:43.923 | INFO     | __main__:main:1176 -   Computing hybrid scores (H1-H4)...
2026-02-20 03:26:43.924 | INFO     | __main__:main:1182 -   Running noise injection evaluation...
2026-02-20 03:26:43.932 | INFO     | __main__:main:1224 -   Running significance tests...
2026-02-20 03:26:43.933 | INFO     | __main__:main:1242 -   Running quadrant analysis...
2026-02-20 03:26:43.934 | INFO     | __main__:main:1254 -   Computing Schoener's D niche overlap...
2026-02-20 03:26:43.934 | INFO     | __main__:main:1262 -   Per-class CRND analysis...
2026-02-20 03:26:43.934 | INFO     | __main__:main:1268 -   Testing niche overlap → classifier prediction...
2026-02-20 03:26:43.935 | INFO     | __main__:main:1309 -   Building per-instance output...
2026-02-20 03:26:43.937 | INFO     | __main__:main:1376 -   mimic_iv_ed_demo completed in 2s (3 examples)
2026-02-20 03:26:44.094 | INFO     | __main__:main:1087 - === [3/5] Processing ohsumed_single (N=3) ===
2026-02-20 03:26:44.095 | INFO     | __main__:main:1092 -   Classes (1): ['Bacterial_Infections_and_Mycoses']
2026-02-20 03:26:44.096 | INFO     | __main__:main:1097 -   Building TF-IDF features...
2026-02-20 03:26:44.102 | DEBUG    | __main__:build_tfidf_features:195 - TF-IDF shape: (3, 12)
2026-02-20 03:26:44.102 | INFO     | __main__:main:1100 -   Building sentence embeddings...
2026-02-20 03:26:46.076 | DEBUG    | __main__:main:1102 -   Embeddings shape: (3, 384)
2026-02-20 03:26:46.077 | INFO     | __main__:main:1127 -   Building char n-gram features (fallback for LLM)...
2026-02-20 03:26:46.094 | DEBUG    | __main__:build_doc2vec_features:376 - Char n-gram features shape: (3, 100)
2026-02-20 03:26:46.094 | INFO     | __main__:main:1151 -   Working subset size: 3
2026-02-20 03:26:46.095 | INFO     | __main__:main:1156 -   Computing CRND scores...
2026-02-20 03:26:46.104 | INFO     | __main__:main:1159 -   Computing label entropy (kDN per space)...
2026-02-20 03:26:46.107 | INFO     | __main__:main:1165 -   Computing cleanlab scores...
2026-02-20 03:26:46.109 | WARNING  | __main__:compute_cleanlab_scores:474 - cross_val_predict failed — returning uniform scores
2026-02-20 03:26:46.111 | WARNING  | __main__:compute_cleanlab_scores:474 - cross_val_predict failed — returning uniform scores
2026-02-20 03:26:46.111 | INFO     | __main__:main:1170 -   Computing WANN-adapted scores...
2026-02-20 03:26:46.113 | INFO     | __main__:main:1173 -   Computing cartography proxy scores...
2026-02-20 03:26:46.115 | WARNING  | __main__:compute_cartography_proxy:552 - Cartography CV round 0 failed
2026-02-20 03:26:46.116 | WARNING  | __main__:compute_cartography_proxy:552 - Cartography CV round 1 failed
2026-02-20 03:26:46.130 | WARNING  | __main__:compute_cartography_proxy:552 - Cartography CV round 2 failed
2026-02-20 03:26:46.133 | WARNING  | __main__:compute_cartography_proxy:552 - Cartography CV round 3 failed
2026-02-20 03:26:46.135 | WARNING  | __main__:compute_cartography_proxy:552 - Cartography CV round 4 failed
2026-02-20 03:26:46.135 | INFO     | __main__:main:1176 -   Computing hybrid scores (H1-H4)...
2026-02-20 03:26:46.135 | INFO     | __main__:main:1182 -   Running noise injection evaluation...
2026-02-20 03:26:46.138 | INFO     | __main__:main:1224 -   Running significance tests...
2026-02-20 03:26:46.138 | INFO     | __main__:main:1242 -   Running quadrant analysis...
2026-02-20 03:26:46.139 | INFO     | __main__:main:1254 -   Computing Schoener's D niche overlap...
2026-02-20 03:26:46.141 | INFO     | __main__:main:1262 -   Per-class CRND analysis...
2026-02-20 03:26:46.143 | INFO     | __main__:main:1268 -   Testing niche overlap → classifier prediction...
2026-02-20 03:26:46.143 | INFO     | __main__:main:1309 -   Building per-instance output...
2026-02-20 03:26:46.144 | INFO     | __main__:main:1376 -   ohsumed_single completed in 2s (3 examples)
2026-02-20 03:26:46.305 | INFO     | __main__:main:1087 - === [4/5] Processing mental_health_conditions (N=3) ===
2026-02-20 03:26:46.322 | INFO     | __main__:main:1092 -   Classes (3): ['anxiety', 'depression', 'personality disorder']
2026-02-20 03:26:46.322 | INFO     | __main__:main:1097 -   Building TF-IDF features...
2026-02-20 03:26:46.324 | DEBUG    | __main__:build_tfidf_features:195 - TF-IDF shape: (3, 2)
2026-02-20 03:26:46.324 | INFO     | __main__:main:1100 -   Building sentence embeddings...
2026-02-20 03:26:47.403 | DEBUG    | __main__:main:1102 -   Embeddings shape: (3, 384)
2026-02-20 03:26:47.403 | INFO     | __main__:main:1127 -   Building char n-gram features (fallback for LLM)...
2026-02-20 03:26:47.408 | DEBUG    | __main__:build_doc2vec_features:376 - Char n-gram features shape: (3, 100)
2026-02-20 03:26:47.409 | INFO     | __main__:main:1151 -   Working subset size: 3
2026-02-20 03:26:47.409 | INFO     | __main__:main:1156 -   Computing CRND scores...
2026-02-20 03:26:47.413 | INFO     | __main__:main:1159 -   Computing label entropy (kDN per space)...
2026-02-20 03:26:47.417 | INFO     | __main__:main:1165 -   Computing cleanlab scores...
2026-02-20 03:26:47.419 | WARNING  | __main__:compute_cleanlab_scores:474 - cross_val_predict failed — returning uniform scores
2026-02-20 03:26:47.420 | WARNING  | __main__:compute_cleanlab_scores:474 - cross_val_predict failed — returning uniform scores
2026-02-20 03:26:47.420 | INFO     | __main__:main:1170 -   Computing WANN-adapted scores...
2026-02-20 03:26:47.421 | INFO     | __main__:main:1173 -   Computing cartography proxy scores...
2026-02-20 03:26:47.423 | WARNING  | __main__:compute_cartography_proxy:552 - Cartography CV round 0 failed
2026-02-20 03:26:47.424 | WARNING  | __main__:compute_cartography_proxy:552 - Cartography CV round 1 failed
2026-02-20 03:26:47.425 | WARNING  | __main__:compute_cartography_proxy:552 - Cartography CV round 2 failed
2026-02-20 03:26:47.429 | WARNING  | __main__:compute_cartography_proxy:552 - Cartography CV round 3 failed
2026-02-20 03:26:47.430 | WARNING  | __main__:compute_cartography_proxy:552 - Cartography CV round 4 failed
2026-02-20 03:26:47.434 | INFO     | __main__:main:1176 -   Computing hybrid scores (H1-H4)...
2026-02-20 03:26:47.435 | INFO     | __main__:main:1182 -   Running noise injection evaluation...
2026-02-20 03:26:47.437 | INFO     | __main__:main:1224 -   Running significance tests...
2026-02-20 03:26:47.437 | INFO     | __main__:main:1242 -   Running quadrant analysis...
2026-02-20 03:26:47.438 | INFO     | __main__:main:1254 -   Computing Schoener's D niche overlap...
2026-02-20 03:26:47.438 | INFO     | __main__:main:1262 -   Per-class CRND analysis...
2026-02-20 03:26:47.440 | INFO     | __main__:main:1268 -   Testing niche overlap → classifier prediction...
2026-02-20 03:26:47.444 | INFO     | __main__:main:1309 -   Building per-instance output...
2026-02-20 03:26:47.444 | INFO     | __main__:main:1376 -   mental_health_conditions completed in 1s (3 examples)
2026-02-20 03:26:47.584 | INFO     | __main__:main:1087 - === [5/5] Processing medical_transcriptions (N=3) ===
2026-02-20 03:26:47.585 | INFO     | __main__:main:1092 -   Classes (2): ['internal_medicine', 'surgical']
2026-02-20 03:26:47.585 | INFO     | __main__:main:1097 -   Building TF-IDF features...
2026-02-20 03:26:47.590 | DEBUG    | __main__:build_tfidf_features:195 - TF-IDF shape: (3, 100)
2026-02-20 03:26:47.590 | INFO     | __main__:main:1100 -   Building sentence embeddings...
2026-02-20 03:26:48.593 | DEBUG    | __main__:main:1102 -   Embeddings shape: (3, 384)
2026-02-20 03:26:48.593 | INFO     | __main__:main:1127 -   Building char n-gram features (fallback for LLM)...
2026-02-20 03:26:48.624 | DEBUG    | __main__:build_doc2vec_features:376 - Char n-gram features shape: (3, 100)
2026-02-20 03:26:48.624 | INFO     | __main__:main:1151 -   Working subset size: 3
2026-02-20 03:26:48.624 | INFO     | __main__:main:1156 -   Computing CRND scores...
2026-02-20 03:26:48.632 | INFO     | __main__:main:1159 -   Computing label entropy (kDN per space)...
2026-02-20 03:26:48.634 | INFO     | __main__:main:1165 -   Computing cleanlab scores...
2026-02-20 03:26:48.636 | WARNING  | __main__:compute_cleanlab_scores:474 - cross_val_predict failed — returning uniform scores
2026-02-20 03:26:48.647 | WARNING  | __main__:compute_cleanlab_scores:474 - cross_val_predict failed — returning uniform scores
2026-02-20 03:26:48.647 | INFO     | __main__:main:1170 -   Computing WANN-adapted scores...
2026-02-20 03:26:48.649 | INFO     | __main__:main:1173 -   Computing cartography proxy scores...
2026-02-20 03:26:48.651 | WARNING  | __main__:compute_cartography_proxy:552 - Cartography CV round 0 failed
2026-02-20 03:26:48.653 | WARNING  | __main__:compute_cartography_proxy:552 - Cartography CV round 1 failed
2026-02-20 03:26:48.656 | WARNING  | __main__:compute_cartography_proxy:552 - Cartography CV round 2 failed
2026-02-20 03:26:48.664 | WARNING  | __main__:compute_cartography_proxy:552 - Cartography CV round 3 failed
2026-02-20 03:26:48.667 | WARNING  | __main__:compute_cartography_proxy:552 - Cartography CV round 4 failed
2026-02-20 03:26:48.667 | INFO     | __main__:main:1176 -   Computing hybrid scores (H1-H4)...
2026-02-20 03:26:48.667 | INFO     | __main__:main:1182 -   Running noise injection evaluation...
2026-02-20 03:26:48.672 | INFO     | __main__:main:1224 -   Running significance tests...
2026-02-20 03:26:48.673 | INFO     | __main__:main:1242 -   Running quadrant analysis...
2026-02-20 03:26:48.673 | INFO     | __main__:main:1254 -   Computing Schoener's D niche overlap...
2026-02-20 03:26:48.674 | INFO     | __main__:main:1262 -   Per-class CRND analysis...
2026-02-20 03:26:48.675 | INFO     | __main__:main:1268 -   Testing niche overlap → classifier prediction...
2026-02-20 03:26:48.685 | INFO     | __main__:main:1309 -   Building per-instance output...
2026-02-20 03:26:48.685 | INFO     | __main__:main:1376 -   medical_transcriptions completed in 1s (3 examples)
2026-02-20 03:26:48.813 | SUCCESS  | __main__:main:1415 - Saved method_out.json (15 examples across 5 datasets) in 19s
2026-02-20 03:26:48.814 | INFO     | __main__:main:1419 - LLM calls: 0, cost: $0.000
2026-02-20 03:26:56.486 | INFO     | __main__:load_and_prepare_datasets:143 - Skipping clinical_patient_triage_nl (N=31, too small for k-NN)
2026-02-20 03:26:56.490 | WARNING  | __main__:load_and_prepare_datasets:146 - Duplicate dataset 'medical_abstracts' — keeping first occurrence
2026-02-20 03:26:56.490 | INFO     | __main__:load_and_prepare_datasets:175 - medical_abstracts: using all 3
2026-02-20 03:26:56.490 | INFO     | __main__:load_and_prepare_datasets:175 - mimic_iv_ed_demo: using all 3
2026-02-20 03:26:56.490 | INFO     | __main__:load_and_prepare_datasets:175 - ohsumed_single: using all 3
2026-02-20 03:26:56.491 | INFO     | __main__:load_and_prepare_datasets:175 - mental_health_conditions: using all 3
2026-02-20 03:26:56.491 | INFO     | __main__:load_and_prepare_datasets:175 - medical_transcriptions: using all 3
2026-02-20 03:26:56.491 | INFO     | __main__:main:1075 - Loaded 5 datasets: ['medical_abstracts', 'mimic_iv_ed_demo', 'ohsumed_single', 'mental_health_conditions', 'medical_transcriptions']
2026-02-20 03:27:08.672 | INFO     | __main__:main:1087 - === [1/5] Processing medical_abstracts (N=3) ===
2026-02-20 03:27:08.672 | INFO     | __main__:main:1092 -   Classes (3): ['Digestive_system_diseases', 'General_pathological_conditions', 'Neoplasms']
2026-02-20 03:27:08.673 | INFO     | __main__:main:1097 -   Building TF-IDF features...
2026-02-20 03:27:08.675 | DEBUG    | __main__:build_tfidf_features:195 - TF-IDF shape: (3, 6)
2026-02-20 03:27:08.675 | INFO     | __main__:main:1100 -   Building sentence embeddings...
2026-02-20 03:27:11.651 | DEBUG    | __main__:main:1102 -   Embeddings shape: (3, 384)
2026-02-20 03:27:11.651 | INFO     | __main__:main:1127 -   Building char n-gram features (fallback for LLM)...
2026-02-20 03:27:12.061 | DEBUG    | __main__:build_doc2vec_features:376 - Char n-gram features shape: (3, 100)
2026-02-20 03:27:12.061 | INFO     | __main__:main:1151 -   Working subset size: 3
2026-02-20 03:27:12.061 | INFO     | __main__:main:1156 -   Computing CRND scores...
2026-02-20 03:27:12.065 | INFO     | __main__:main:1159 -   Computing label entropy (kDN per space)...
2026-02-20 03:27:12.068 | INFO     | __main__:main:1165 -   Computing cleanlab scores...
2026-02-20 03:27:12.070 | WARNING  | __main__:compute_cleanlab_scores:474 - cross_val_predict failed — returning uniform scores
2026-02-20 03:27:12.073 | WARNING  | __main__:compute_cleanlab_scores:474 - cross_val_predict failed — returning uniform scores
2026-02-20 03:27:12.074 | INFO     | __main__:main:1170 -   Computing WANN-adapted scores...
2026-02-20 03:27:12.075 | INFO     | __main__:main:1173 -   Computing cartography proxy scores...
2026-02-20 03:27:12.076 | WARNING  | __main__:compute_cartography_proxy:552 - Cartography CV round 0 failed
2026-02-20 03:27:12.102 | WARNING  | __main__:compute_cartography_proxy:552 - Cartography CV round 1 failed
2026-02-20 03:27:12.103 | WARNING  | __main__:compute_cartography_proxy:552 - Cartography CV round 2 failed
2026-02-20 03:27:12.104 | WARNING  | __main__:compute_cartography_proxy:552 - Cartography CV round 3 failed
2026-02-20 03:27:12.105 | WARNING  | __main__:compute_cartography_proxy:552 - Cartography CV round 4 failed
2026-02-20 03:27:12.106 | INFO     | __main__:main:1176 -   Computing hybrid scores (H1-H4)...
2026-02-20 03:27:12.106 | INFO     | __main__:main:1182 -   Running noise injection evaluation...
2026-02-20 03:27:12.109 | INFO     | __main__:main:1224 -   Running significance tests...
2026-02-20 03:27:12.110 | INFO     | __main__:main:1242 -   Running quadrant analysis...
2026-02-20 03:27:12.111 | INFO     | __main__:main:1254 -   Computing Schoener's D niche overlap...
2026-02-20 03:27:12.111 | INFO     | __main__:main:1262 -   Per-class CRND analysis...
2026-02-20 03:27:12.112 | INFO     | __main__:main:1268 -   Testing niche overlap → classifier prediction...
2026-02-20 03:27:12.115 | INFO     | __main__:main:1309 -   Building per-instance output...
2026-02-20 03:27:12.116 | INFO     | __main__:main:1376 -   medical_abstracts completed in 3s (3 examples)
2026-02-20 03:27:12.292 | INFO     | __main__:main:1087 - === [2/5] Processing mimic_iv_ed_demo (N=3) ===
2026-02-20 03:27:12.322 | INFO     | __main__:main:1092 -   Classes (1): ['ESI-2']
2026-02-20 03:27:12.322 | INFO     | __main__:main:1097 -   Building TF-IDF features...
2026-02-20 03:27:12.324 | DEBUG    | __main__:build_tfidf_features:195 - TF-IDF shape: (3, 4)
2026-02-20 03:27:12.324 | INFO     | __main__:main:1100 -   Building sentence embeddings...
2026-02-20 03:27:14.206 | DEBUG    | __main__:main:1102 -   Embeddings shape: (3, 384)
2026-02-20 03:27:14.206 | INFO     | __main__:main:1127 -   Building char n-gram features (fallback for LLM)...
2026-02-20 03:27:14.209 | DEBUG    | __main__:build_doc2vec_features:376 - Char n-gram features shape: (3, 11)
2026-02-20 03:27:14.209 | INFO     | __main__:main:1151 -   Working subset size: 3
2026-02-20 03:27:14.209 | INFO     | __main__:main:1156 -   Computing CRND scores...
2026-02-20 03:27:14.212 | INFO     | __main__:main:1159 -   Computing label entropy (kDN per space)...
2026-02-20 03:27:14.215 | INFO     | __main__:main:1165 -   Computing cleanlab scores...
2026-02-20 03:27:14.217 | WARNING  | __main__:compute_cleanlab_scores:474 - cross_val_predict failed — returning uniform scores
2026-02-20 03:27:14.236 | WARNING  | __main__:compute_cleanlab_scores:474 - cross_val_predict failed — returning uniform scores
2026-02-20 03:27:14.236 | INFO     | __main__:main:1170 -   Computing WANN-adapted scores...
2026-02-20 03:27:14.239 | INFO     | __main__:main:1173 -   Computing cartography proxy scores...
2026-02-20 03:27:14.242 | WARNING  | __main__:compute_cartography_proxy:552 - Cartography CV round 0 failed
2026-02-20 03:27:14.252 | WARNING  | __main__:compute_cartography_proxy:552 - Cartography CV round 1 failed
2026-02-20 03:27:14.254 | WARNING  | __main__:compute_cartography_proxy:552 - Cartography CV round 2 failed
2026-02-20 03:27:14.256 | WARNING  | __main__:compute_cartography_proxy:552 - Cartography CV round 3 failed
2026-02-20 03:27:14.269 | WARNING  | __main__:compute_cartography_proxy:552 - Cartography CV round 4 failed
2026-02-20 03:27:14.269 | INFO     | __main__:main:1176 -   Computing hybrid scores (H1-H4)...
2026-02-20 03:27:14.270 | INFO     | __main__:main:1182 -   Running noise injection evaluation...
2026-02-20 03:27:14.282 | INFO     | __main__:main:1224 -   Running significance tests...
2026-02-20 03:27:14.283 | INFO     | __main__:main:1242 -   Running quadrant analysis...
2026-02-20 03:27:14.283 | INFO     | __main__:main:1254 -   Computing Schoener's D niche overlap...
2026-02-20 03:27:14.284 | INFO     | __main__:main:1262 -   Per-class CRND analysis...
2026-02-20 03:27:14.284 | INFO     | __main__:main:1268 -   Testing niche overlap → classifier prediction...
2026-02-20 03:27:14.284 | INFO     | __main__:main:1309 -   Building per-instance output...
2026-02-20 03:27:14.285 | INFO     | __main__:main:1376 -   mimic_iv_ed_demo completed in 2s (3 examples)
2026-02-20 03:27:14.549 | INFO     | __main__:main:1087 - === [3/5] Processing ohsumed_single (N=3) ===
2026-02-20 03:27:14.549 | INFO     | __main__:main:1092 -   Classes (1): ['Bacterial_Infections_and_Mycoses']
2026-02-20 03:27:14.549 | INFO     | __main__:main:1097 -   Building TF-IDF features...
2026-02-20 03:27:14.552 | DEBUG    | __main__:build_tfidf_features:195 - TF-IDF shape: (3, 12)
2026-02-20 03:27:14.552 | INFO     | __main__:main:1100 -   Building sentence embeddings...
2026-02-20 03:27:15.786 | DEBUG    | __main__:main:1102 -   Embeddings shape: (3, 384)
2026-02-20 03:27:15.786 | INFO     | __main__:main:1127 -   Building char n-gram features (fallback for LLM)...
2026-02-20 03:27:15.798 | DEBUG    | __main__:build_doc2vec_features:376 - Char n-gram features shape: (3, 100)
2026-02-20 03:27:15.799 | INFO     | __main__:main:1151 -   Working subset size: 3
2026-02-20 03:27:15.799 | INFO     | __main__:main:1156 -   Computing CRND scores...
2026-02-20 03:27:15.802 | INFO     | __main__:main:1159 -   Computing label entropy (kDN per space)...
2026-02-20 03:27:15.805 | INFO     | __main__:main:1165 -   Computing cleanlab scores...
2026-02-20 03:27:15.807 | WARNING  | __main__:compute_cleanlab_scores:474 - cross_val_predict failed — returning uniform scores
2026-02-20 03:27:15.813 | WARNING  | __main__:compute_cleanlab_scores:474 - cross_val_predict failed — returning uniform scores
2026-02-20 03:27:15.813 | INFO     | __main__:main:1170 -   Computing WANN-adapted scores...
2026-02-20 03:27:15.814 | INFO     | __main__:main:1173 -   Computing cartography proxy scores...
2026-02-20 03:27:15.816 | WARNING  | __main__:compute_cartography_proxy:552 - Cartography CV round 0 failed
2026-02-20 03:27:15.818 | WARNING  | __main__:compute_cartography_proxy:552 - Cartography CV round 1 failed
2026-02-20 03:27:15.819 | WARNING  | __main__:compute_cartography_proxy:552 - Cartography CV round 2 failed
2026-02-20 03:27:15.821 | WARNING  | __main__:compute_cartography_proxy:552 - Cartography CV round 3 failed
2026-02-20 03:27:15.823 | WARNING  | __main__:compute_cartography_proxy:552 - Cartography CV round 4 failed
2026-02-20 03:27:15.826 | INFO     | __main__:main:1176 -   Computing hybrid scores (H1-H4)...
2026-02-20 03:27:15.827 | INFO     | __main__:main:1182 -   Running noise injection evaluation...
2026-02-20 03:27:15.831 | INFO     | __main__:main:1224 -   Running significance tests...
2026-02-20 03:27:15.832 | INFO     | __main__:main:1242 -   Running quadrant analysis...
2026-02-20 03:27:15.832 | INFO     | __main__:main:1254 -   Computing Schoener's D niche overlap...
2026-02-20 03:27:15.832 | INFO     | __main__:main:1262 -   Per-class CRND analysis...
2026-02-20 03:27:15.833 | INFO     | __main__:main:1268 -   Testing niche overlap → classifier prediction...
2026-02-20 03:27:15.833 | INFO     | __main__:main:1309 -   Building per-instance output...
2026-02-20 03:27:15.834 | INFO     | __main__:main:1376 -   ohsumed_single completed in 1s (3 examples)
2026-02-20 03:27:16.177 | INFO     | __main__:main:1087 - === [4/5] Processing mental_health_conditions (N=3) ===
2026-02-20 03:27:16.178 | INFO     | __main__:main:1092 -   Classes (3): ['anxiety', 'depression', 'personality disorder']
2026-02-20 03:27:16.183 | INFO     | __main__:main:1097 -   Building TF-IDF features...
2026-02-20 03:27:16.203 | DEBUG    | __main__:build_tfidf_features:195 - TF-IDF shape: (3, 2)
2026-02-20 03:27:16.204 | INFO     | __main__:main:1100 -   Building sentence embeddings...
2026-02-20 03:27:17.289 | DEBUG    | __main__:main:1102 -   Embeddings shape: (3, 384)
2026-02-20 03:27:17.289 | INFO     | __main__:main:1127 -   Building char n-gram features (fallback for LLM)...
2026-02-20 03:27:17.293 | DEBUG    | __main__:build_doc2vec_features:376 - Char n-gram features shape: (3, 100)
2026-02-20 03:27:17.293 | INFO     | __main__:main:1151 -   Working subset size: 3
2026-02-20 03:27:17.293 | INFO     | __main__:main:1156 -   Computing CRND scores...
2026-02-20 03:27:17.298 | INFO     | __main__:main:1159 -   Computing label entropy (kDN per space)...
2026-02-20 03:27:17.301 | INFO     | __main__:main:1165 -   Computing cleanlab scores...
2026-02-20 03:27:17.302 | WARNING  | __main__:compute_cleanlab_scores:474 - cross_val_predict failed — returning uniform scores
2026-02-20 03:27:17.303 | WARNING  | __main__:compute_cleanlab_scores:474 - cross_val_predict failed — returning uniform scores
2026-02-20 03:27:17.304 | INFO     | __main__:main:1170 -   Computing WANN-adapted scores...
2026-02-20 03:27:17.305 | INFO     | __main__:main:1173 -   Computing cartography proxy scores...
2026-02-20 03:27:17.306 | WARNING  | __main__:compute_cartography_proxy:552 - Cartography CV round 0 failed
2026-02-20 03:27:17.306 | WARNING  | __main__:compute_cartography_proxy:552 - Cartography CV round 1 failed
2026-02-20 03:27:17.307 | WARNING  | __main__:compute_cartography_proxy:552 - Cartography CV round 2 failed
2026-02-20 03:27:17.308 | WARNING  | __main__:compute_cartography_proxy:552 - Cartography CV round 3 failed
2026-02-20 03:27:17.309 | WARNING  | __main__:compute_cartography_proxy:552 - Cartography CV round 4 failed
2026-02-20 03:27:17.312 | INFO     | __main__:main:1176 -   Computing hybrid scores (H1-H4)...
2026-02-20 03:27:17.313 | INFO     | __main__:main:1182 -   Running noise injection evaluation...
2026-02-20 03:27:17.317 | INFO     | __main__:main:1224 -   Running significance tests...
2026-02-20 03:27:17.317 | INFO     | __main__:main:1242 -   Running quadrant analysis...
2026-02-20 03:27:17.318 | INFO     | __main__:main:1254 -   Computing Schoener's D niche overlap...
2026-02-20 03:27:17.318 | INFO     | __main__:main:1262 -   Per-class CRND analysis...
2026-02-20 03:27:17.320 | INFO     | __main__:main:1268 -   Testing niche overlap → classifier prediction...
2026-02-20 03:27:17.324 | INFO     | __main__:main:1309 -   Building per-instance output...
2026-02-20 03:27:17.324 | INFO     | __main__:main:1376 -   mental_health_conditions completed in 1s (3 examples)
2026-02-20 03:27:17.498 | INFO     | __main__:main:1087 - === [5/5] Processing medical_transcriptions (N=3) ===
2026-02-20 03:27:17.498 | INFO     | __main__:main:1092 -   Classes (2): ['internal_medicine', 'surgical']
2026-02-20 03:27:17.498 | INFO     | __main__:main:1097 -   Building TF-IDF features...
2026-02-20 03:27:17.502 | DEBUG    | __main__:build_tfidf_features:195 - TF-IDF shape: (3, 100)
2026-02-20 03:27:17.502 | INFO     | __main__:main:1100 -   Building sentence embeddings...
2026-02-20 03:27:18.600 | DEBUG    | __main__:main:1102 -   Embeddings shape: (3, 384)
2026-02-20 03:27:18.600 | INFO     | __main__:main:1127 -   Building char n-gram features (fallback for LLM)...
2026-02-20 03:27:18.619 | DEBUG    | __main__:build_doc2vec_features:376 - Char n-gram features shape: (3, 100)
2026-02-20 03:27:18.619 | INFO     | __main__:main:1151 -   Working subset size: 3
2026-02-20 03:27:18.619 | INFO     | __main__:main:1156 -   Computing CRND scores...
2026-02-20 03:27:18.622 | INFO     | __main__:main:1159 -   Computing label entropy (kDN per space)...
2026-02-20 03:27:18.624 | INFO     | __main__:main:1165 -   Computing cleanlab scores...
2026-02-20 03:27:18.626 | WARNING  | __main__:compute_cleanlab_scores:474 - cross_val_predict failed — returning uniform scores
2026-02-20 03:27:18.630 | WARNING  | __main__:compute_cleanlab_scores:474 - cross_val_predict failed — returning uniform scores
2026-02-20 03:27:18.630 | INFO     | __main__:main:1170 -   Computing WANN-adapted scores...
2026-02-20 03:27:18.632 | INFO     | __main__:main:1173 -   Computing cartography proxy scores...
2026-02-20 03:27:18.634 | WARNING  | __main__:compute_cartography_proxy:552 - Cartography CV round 0 failed
2026-02-20 03:27:18.637 | WARNING  | __main__:compute_cartography_proxy:552 - Cartography CV round 1 failed
2026-02-20 03:27:18.640 | WARNING  | __main__:compute_cartography_proxy:552 - Cartography CV round 2 failed
2026-02-20 03:27:18.644 | WARNING  | __main__:compute_cartography_proxy:552 - Cartography CV round 3 failed
2026-02-20 03:27:18.646 | WARNING  | __main__:compute_cartography_proxy:552 - Cartography CV round 4 failed
2026-02-20 03:27:18.646 | INFO     | __main__:main:1176 -   Computing hybrid scores (H1-H4)...
2026-02-20 03:27:18.646 | INFO     | __main__:main:1182 -   Running noise injection evaluation...
2026-02-20 03:27:18.649 | INFO     | __main__:main:1224 -   Running significance tests...
2026-02-20 03:27:18.649 | INFO     | __main__:main:1242 -   Running quadrant analysis...
2026-02-20 03:27:18.649 | INFO     | __main__:main:1254 -   Computing Schoener's D niche overlap...
2026-02-20 03:27:18.649 | INFO     | __main__:main:1262 -   Per-class CRND analysis...
2026-02-20 03:27:18.650 | INFO     | __main__:main:1268 -   Testing niche overlap → classifier prediction...
2026-02-20 03:27:18.656 | INFO     | __main__:main:1309 -   Building per-instance output...
2026-02-20 03:27:18.656 | INFO     | __main__:main:1376 -   medical_transcriptions completed in 1s (3 examples)
2026-02-20 03:27:18.782 | SUCCESS  | __main__:main:1415 - Saved method_out.json (15 examples across 5 datasets) in 22s
2026-02-20 03:27:18.782 | INFO     | __main__:main:1419 - LLM calls: 0, cost: $0.000
2026-02-20 03:27:40.237 | INFO     | __main__:load_and_prepare_datasets:143 - Skipping clinical_patient_triage_nl (N=31, too small for k-NN)
2026-02-20 03:27:40.578 | WARNING  | __main__:load_and_prepare_datasets:146 - Duplicate dataset 'medical_abstracts' — keeping first occurrence
2026-02-20 03:27:40.580 | INFO     | __main__:load_and_prepare_datasets:159 - medical_abstracts: trimmed to 10/14438
2026-02-20 03:27:40.580 | INFO     | __main__:load_and_prepare_datasets:159 - mimic_iv_ed_demo: trimmed to 10/207
2026-02-20 03:27:40.580 | INFO     | __main__:load_and_prepare_datasets:159 - ohsumed_single: trimmed to 10/7400
2026-02-20 03:27:40.580 | INFO     | __main__:load_and_prepare_datasets:159 - mental_health_conditions: trimmed to 10/15000
2026-02-20 03:27:40.580 | INFO     | __main__:load_and_prepare_datasets:159 - medical_transcriptions: trimmed to 10/4966
2026-02-20 03:27:40.590 | INFO     | __main__:load_and_prepare_datasets:175 - medical_abstracts: using all 10
2026-02-20 03:27:40.590 | INFO     | __main__:load_and_prepare_datasets:175 - mimic_iv_ed_demo: using all 10
2026-02-20 03:27:40.590 | INFO     | __main__:load_and_prepare_datasets:175 - ohsumed_single: using all 10
2026-02-20 03:27:40.590 | INFO     | __main__:load_and_prepare_datasets:175 - mental_health_conditions: using all 10
2026-02-20 03:27:40.590 | INFO     | __main__:load_and_prepare_datasets:175 - medical_transcriptions: using all 10
2026-02-20 03:27:40.595 | INFO     | __main__:main:1075 - Loaded 5 datasets: ['medical_abstracts', 'mimic_iv_ed_demo', 'ohsumed_single', 'mental_health_conditions', 'medical_transcriptions']
2026-02-20 03:27:49.241 | INFO     | __main__:main:1087 - === [1/5] Processing medical_abstracts (N=10) ===
2026-02-20 03:27:49.241 | INFO     | __main__:main:1092 -   Classes (5): ['Cardiovascular_diseases', 'Digestive_system_diseases', 'General_pathological_conditions', 'Neoplasms', 'Nervous_system_diseases']
2026-02-20 03:27:49.242 | INFO     | __main__:main:1097 -   Building TF-IDF features...
2026-02-20 03:27:49.246 | DEBUG    | __main__:build_tfidf_features:195 - TF-IDF shape: (10, 83)
2026-02-20 03:27:49.247 | INFO     | __main__:main:1100 -   Building sentence embeddings...
2026-02-20 03:27:50.648 | DEBUG    | __main__:main:1102 -   Embeddings shape: (10, 384)
2026-02-20 03:27:50.648 | INFO     | __main__:main:1127 -   Building char n-gram features (fallback for LLM)...
2026-02-20 03:27:50.688 | DEBUG    | __main__:build_doc2vec_features:376 - Char n-gram features shape: (10, 100)
2026-02-20 03:27:50.688 | INFO     | __main__:main:1151 -   Working subset size: 10
2026-02-20 03:27:50.693 | INFO     | __main__:main:1156 -   Computing CRND scores...
2026-02-20 03:27:50.698 | INFO     | __main__:main:1159 -   Computing label entropy (kDN per space)...
2026-02-20 03:27:50.704 | INFO     | __main__:main:1165 -   Computing cleanlab scores...
2026-02-20 03:27:51.063 | INFO     | __main__:main:1170 -   Computing WANN-adapted scores...
2026-02-20 03:27:51.065 | INFO     | __main__:main:1173 -   Computing cartography proxy scores...
2026-02-20 03:27:51.500 | INFO     | __main__:main:1176 -   Computing hybrid scores (H1-H4)...
2026-02-20 03:27:51.500 | INFO     | __main__:main:1182 -   Running noise injection evaluation...
2026-02-20 03:27:51.775 | INFO     | __main__:main:1224 -   Running significance tests...
2026-02-20 03:27:56.945 | INFO     | __main__:main:1242 -   Running quadrant analysis...
2026-02-20 03:27:56.946 | INFO     | __main__:main:1254 -   Computing Schoener's D niche overlap...
2026-02-20 03:27:56.946 | INFO     | __main__:main:1262 -   Per-class CRND analysis...
2026-02-20 03:27:56.948 | INFO     | __main__:main:1268 -   Testing niche overlap → classifier prediction...
2026-02-20 03:27:57.088 | INFO     | __main__:main:1309 -   Building per-instance output...
2026-02-20 03:27:57.088 | INFO     | __main__:main:1376 -   medical_abstracts completed in 8s (10 examples)
2026-02-20 03:27:57.245 | INFO     | __main__:main:1087 - === [2/5] Processing mimic_iv_ed_demo (N=10) ===
2026-02-20 03:27:57.246 | INFO     | __main__:main:1092 -   Classes (1): ['ESI-2']
2026-02-20 03:27:57.246 | INFO     | __main__:main:1097 -   Building TF-IDF features...
2026-02-20 03:27:57.248 | DEBUG    | __main__:build_tfidf_features:195 - TF-IDF shape: (10, 34)
2026-02-20 03:27:57.248 | INFO     | __main__:main:1100 -   Building sentence embeddings...
2026-02-20 03:27:58.455 | DEBUG    | __main__:main:1102 -   Embeddings shape: (10, 384)
2026-02-20 03:27:58.455 | INFO     | __main__:main:1127 -   Building char n-gram features (fallback for LLM)...
2026-02-20 03:27:58.461 | DEBUG    | __main__:build_doc2vec_features:376 - Char n-gram features shape: (10, 100)
2026-02-20 03:27:58.461 | INFO     | __main__:main:1151 -   Working subset size: 10
2026-02-20 03:27:58.462 | INFO     | __main__:main:1156 -   Computing CRND scores...
2026-02-20 03:27:58.466 | INFO     | __main__:main:1159 -   Computing label entropy (kDN per space)...
2026-02-20 03:27:58.471 | INFO     | __main__:main:1165 -   Computing cleanlab scores...
2026-02-20 03:27:58.473 | WARNING  | __main__:compute_cleanlab_scores:474 - cross_val_predict failed — returning uniform scores
2026-02-20 03:27:58.474 | WARNING  | __main__:compute_cleanlab_scores:474 - cross_val_predict failed — returning uniform scores
2026-02-20 03:27:58.474 | INFO     | __main__:main:1170 -   Computing WANN-adapted scores...
2026-02-20 03:27:58.475 | INFO     | __main__:main:1173 -   Computing cartography proxy scores...
2026-02-20 03:27:58.477 | WARNING  | __main__:compute_cartography_proxy:552 - Cartography CV round 0 failed
2026-02-20 03:27:58.478 | WARNING  | __main__:compute_cartography_proxy:552 - Cartography CV round 1 failed
2026-02-20 03:27:58.480 | WARNING  | __main__:compute_cartography_proxy:552 - Cartography CV round 2 failed
2026-02-20 03:27:58.482 | WARNING  | __main__:compute_cartography_proxy:552 - Cartography CV round 3 failed
2026-02-20 03:27:58.483 | WARNING  | __main__:compute_cartography_proxy:552 - Cartography CV round 4 failed
2026-02-20 03:27:58.483 | INFO     | __main__:main:1176 -   Computing hybrid scores (H1-H4)...
2026-02-20 03:27:58.484 | INFO     | __main__:main:1182 -   Running noise injection evaluation...
2026-02-20 03:27:58.712 | INFO     | __main__:main:1224 -   Running significance tests...
2026-02-20 03:28:06.206 | INFO     | __main__:main:1242 -   Running quadrant analysis...
2026-02-20 03:28:06.206 | INFO     | __main__:main:1254 -   Computing Schoener's D niche overlap...
2026-02-20 03:28:06.207 | INFO     | __main__:main:1262 -   Per-class CRND analysis...
2026-02-20 03:28:06.207 | INFO     | __main__:main:1268 -   Testing niche overlap → classifier prediction...
2026-02-20 03:28:06.208 | INFO     | __main__:main:1309 -   Building per-instance output...
2026-02-20 03:28:06.208 | INFO     | __main__:main:1376 -   mimic_iv_ed_demo completed in 9s (10 examples)
2026-02-20 03:28:06.354 | INFO     | __main__:main:1087 - === [3/5] Processing ohsumed_single (N=10) ===
2026-02-20 03:28:06.354 | INFO     | __main__:main:1092 -   Classes (1): ['Bacterial_Infections_and_Mycoses']
2026-02-20 03:28:06.354 | INFO     | __main__:main:1097 -   Building TF-IDF features...
2026-02-20 03:28:06.359 | DEBUG    | __main__:build_tfidf_features:195 - TF-IDF shape: (10, 100)
2026-02-20 03:28:06.359 | INFO     | __main__:main:1100 -   Building sentence embeddings...
2026-02-20 03:28:07.911 | DEBUG    | __main__:main:1102 -   Embeddings shape: (10, 384)
2026-02-20 03:28:07.911 | INFO     | __main__:main:1127 -   Building char n-gram features (fallback for LLM)...
2026-02-20 03:28:07.935 | DEBUG    | __main__:build_doc2vec_features:376 - Char n-gram features shape: (10, 100)
2026-02-20 03:28:07.935 | INFO     | __main__:main:1151 -   Working subset size: 10
2026-02-20 03:28:07.936 | INFO     | __main__:main:1156 -   Computing CRND scores...
2026-02-20 03:28:07.939 | INFO     | __main__:main:1159 -   Computing label entropy (kDN per space)...
2026-02-20 03:28:07.942 | INFO     | __main__:main:1165 -   Computing cleanlab scores...
2026-02-20 03:28:07.944 | WARNING  | __main__:compute_cleanlab_scores:474 - cross_val_predict failed — returning uniform scores
2026-02-20 03:28:07.945 | WARNING  | __main__:compute_cleanlab_scores:474 - cross_val_predict failed — returning uniform scores
2026-02-20 03:28:07.946 | INFO     | __main__:main:1170 -   Computing WANN-adapted scores...
2026-02-20 03:28:07.947 | INFO     | __main__:main:1173 -   Computing cartography proxy scores...
2026-02-20 03:28:07.948 | WARNING  | __main__:compute_cartography_proxy:552 - Cartography CV round 0 failed
2026-02-20 03:28:07.950 | WARNING  | __main__:compute_cartography_proxy:552 - Cartography CV round 1 failed
2026-02-20 03:28:07.952 | WARNING  | __main__:compute_cartography_proxy:552 - Cartography CV round 2 failed
2026-02-20 03:28:07.954 | WARNING  | __main__:compute_cartography_proxy:552 - Cartography CV round 3 failed
2026-02-20 03:28:07.956 | WARNING  | __main__:compute_cartography_proxy:552 - Cartography CV round 4 failed
2026-02-20 03:28:07.956 | INFO     | __main__:main:1176 -   Computing hybrid scores (H1-H4)...
2026-02-20 03:28:07.957 | INFO     | __main__:main:1182 -   Running noise injection evaluation...
2026-02-20 03:28:08.205 | INFO     | __main__:main:1224 -   Running significance tests...
2026-02-20 03:28:13.794 | INFO     | __main__:main:1242 -   Running quadrant analysis...
2026-02-20 03:28:13.794 | INFO     | __main__:main:1254 -   Computing Schoener's D niche overlap...
2026-02-20 03:28:13.794 | INFO     | __main__:main:1262 -   Per-class CRND analysis...
2026-02-20 03:28:13.795 | INFO     | __main__:main:1268 -   Testing niche overlap → classifier prediction...
2026-02-20 03:28:13.795 | INFO     | __main__:main:1309 -   Building per-instance output...
2026-02-20 03:28:13.796 | INFO     | __main__:main:1376 -   ohsumed_single completed in 7s (10 examples)
2026-02-20 03:28:13.907 | INFO     | __main__:main:1087 - === [4/5] Processing mental_health_conditions (N=10) ===
2026-02-20 03:28:13.908 | INFO     | __main__:main:1092 -   Classes (6): ['anxiety', 'bipolar', 'depression', 'normal', 'personality disorder', 'stress']
2026-02-20 03:28:13.908 | INFO     | __main__:main:1097 -   Building TF-IDF features...
2026-02-20 03:28:13.910 | DEBUG    | __main__:build_tfidf_features:195 - TF-IDF shape: (10, 42)
2026-02-20 03:28:13.910 | INFO     | __main__:main:1100 -   Building sentence embeddings...
2026-02-20 03:28:15.133 | DEBUG    | __main__:main:1102 -   Embeddings shape: (10, 384)
2026-02-20 03:28:15.133 | INFO     | __main__:main:1127 -   Building char n-gram features (fallback for LLM)...
2026-02-20 03:28:15.146 | DEBUG    | __main__:build_doc2vec_features:376 - Char n-gram features shape: (10, 100)
2026-02-20 03:28:15.146 | INFO     | __main__:main:1151 -   Working subset size: 10
2026-02-20 03:28:15.146 | INFO     | __main__:main:1156 -   Computing CRND scores...
2026-02-20 03:28:15.149 | INFO     | __main__:main:1159 -   Computing label entropy (kDN per space)...
2026-02-20 03:28:15.153 | INFO     | __main__:main:1165 -   Computing cleanlab scores...
2026-02-20 03:28:15.408 | INFO     | __main__:main:1170 -   Computing WANN-adapted scores...
2026-02-20 03:28:15.410 | INFO     | __main__:main:1173 -   Computing cartography proxy scores...
2026-02-20 03:28:16.758 | INFO     | __main__:main:1176 -   Computing hybrid scores (H1-H4)...
2026-02-20 03:28:16.759 | INFO     | __main__:main:1182 -   Running noise injection evaluation...
2026-02-20 03:28:17.133 | INFO     | __main__:main:1224 -   Running significance tests...
2026-02-20 03:28:23.930 | INFO     | __main__:main:1242 -   Running quadrant analysis...
2026-02-20 03:28:23.930 | INFO     | __main__:main:1254 -   Computing Schoener's D niche overlap...
2026-02-20 03:28:24.406 | INFO     | __main__:main:1262 -   Per-class CRND analysis...
2026-02-20 03:28:24.408 | INFO     | __main__:main:1268 -   Testing niche overlap → classifier prediction...
2026-02-20 03:28:24.828 | INFO     | __main__:main:1309 -   Building per-instance output...
2026-02-20 03:28:24.840 | INFO     | __main__:main:1376 -   mental_health_conditions completed in 11s (10 examples)
2026-02-20 03:28:25.024 | INFO     | __main__:main:1087 - === [5/5] Processing medical_transcriptions (N=10) ===
2026-02-20 03:28:25.025 | INFO     | __main__:main:1092 -   Classes (3): ['cardiovascular_pulmonary', 'internal_medicine', 'surgical']
2026-02-20 03:28:25.025 | INFO     | __main__:main:1097 -   Building TF-IDF features...
2026-02-20 03:28:25.031 | DEBUG    | __main__:build_tfidf_features:195 - TF-IDF shape: (10, 100)
2026-02-20 03:28:25.031 | INFO     | __main__:main:1100 -   Building sentence embeddings...
2026-02-20 03:28:26.085 | DEBUG    | __main__:main:1102 -   Embeddings shape: (10, 384)
2026-02-20 03:28:26.085 | INFO     | __main__:main:1127 -   Building char n-gram features (fallback for LLM)...
2026-02-20 03:28:26.120 | DEBUG    | __main__:build_doc2vec_features:376 - Char n-gram features shape: (10, 100)
2026-02-20 03:28:26.120 | INFO     | __main__:main:1151 -   Working subset size: 10
2026-02-20 03:28:26.120 | INFO     | __main__:main:1156 -   Computing CRND scores...
2026-02-20 03:28:26.125 | INFO     | __main__:main:1159 -   Computing label entropy (kDN per space)...
2026-02-20 03:28:26.129 | INFO     | __main__:main:1165 -   Computing cleanlab scores...
2026-02-20 03:28:26.343 | INFO     | __main__:main:1170 -   Computing WANN-adapted scores...
2026-02-20 03:28:26.349 | INFO     | __main__:main:1173 -   Computing cartography proxy scores...
2026-02-20 03:28:27.020 | INFO     | __main__:main:1176 -   Computing hybrid scores (H1-H4)...
2026-02-20 03:28:27.020 | INFO     | __main__:main:1182 -   Running noise injection evaluation...
2026-02-20 03:28:27.321 | INFO     | __main__:main:1224 -   Running significance tests...
2026-02-20 03:28:32.353 | INFO     | __main__:main:1242 -   Running quadrant analysis...
2026-02-20 03:28:32.353 | INFO     | __main__:main:1254 -   Computing Schoener's D niche overlap...
2026-02-20 03:28:32.561 | INFO     | __main__:main:1262 -   Per-class CRND analysis...
2026-02-20 03:28:32.562 | INFO     | __main__:main:1268 -   Testing niche overlap → classifier prediction...
2026-02-20 03:28:33.062 | INFO     | __main__:main:1309 -   Building per-instance output...
2026-02-20 03:28:33.063 | INFO     | __main__:main:1376 -   medical_transcriptions completed in 8s (10 examples)
2026-02-20 03:28:33.231 | SUCCESS  | __main__:main:1415 - Saved method_out.json (50 examples across 5 datasets) in 54s
2026-02-20 03:28:33.231 | INFO     | __main__:main:1419 - LLM calls: 0, cost: $0.000
2026-02-20 03:29:03.312 | INFO     | __main__:load_and_prepare_datasets:143 - Skipping clinical_patient_triage_nl (N=31, too small for k-NN)
2026-02-20 03:29:03.642 | WARNING  | __main__:load_and_prepare_datasets:146 - Duplicate dataset 'medical_abstracts' — keeping first occurrence
2026-02-20 03:29:03.643 | INFO     | __main__:load_and_prepare_datasets:159 - medical_abstracts: trimmed to 50/14438
2026-02-20 03:29:03.643 | INFO     | __main__:load_and_prepare_datasets:159 - mimic_iv_ed_demo: trimmed to 50/207
2026-02-20 03:29:03.643 | INFO     | __main__:load_and_prepare_datasets:159 - ohsumed_single: trimmed to 50/7400
2026-02-20 03:29:03.643 | INFO     | __main__:load_and_prepare_datasets:159 - mental_health_conditions: trimmed to 50/15000
2026-02-20 03:29:03.643 | INFO     | __main__:load_and_prepare_datasets:159 - medical_transcriptions: trimmed to 50/4966
2026-02-20 03:29:03.655 | INFO     | __main__:load_and_prepare_datasets:175 - medical_abstracts: using all 50
2026-02-20 03:29:03.656 | INFO     | __main__:load_and_prepare_datasets:175 - mimic_iv_ed_demo: using all 50
2026-02-20 03:29:03.656 | INFO     | __main__:load_and_prepare_datasets:175 - ohsumed_single: using all 50
2026-02-20 03:29:03.656 | INFO     | __main__:load_and_prepare_datasets:175 - mental_health_conditions: using all 50
2026-02-20 03:29:03.656 | INFO     | __main__:load_and_prepare_datasets:175 - medical_transcriptions: using all 50
2026-02-20 03:29:03.662 | INFO     | __main__:main:1075 - Loaded 5 datasets: ['medical_abstracts', 'mimic_iv_ed_demo', 'ohsumed_single', 'mental_health_conditions', 'medical_transcriptions']
2026-02-20 03:29:11.261 | INFO     | __main__:main:1087 - === [1/5] Processing medical_abstracts (N=50) ===
2026-02-20 03:29:11.261 | INFO     | __main__:main:1092 -   Classes (5): ['Cardiovascular_diseases', 'Digestive_system_diseases', 'General_pathological_conditions', 'Neoplasms', 'Nervous_system_diseases']
2026-02-20 03:29:11.261 | INFO     | __main__:main:1097 -   Building TF-IDF features...
2026-02-20 03:29:11.276 | DEBUG    | __main__:build_tfidf_features:195 - TF-IDF shape: (50, 100)
2026-02-20 03:29:11.276 | INFO     | __main__:main:1100 -   Building sentence embeddings...
2026-02-20 03:29:15.371 | DEBUG    | __main__:main:1102 -   Embeddings shape: (50, 384)
2026-02-20 03:29:15.371 | INFO     | __main__:main:1127 -   Building char n-gram features (fallback for LLM)...
2026-02-20 03:29:15.464 | DEBUG    | __main__:build_doc2vec_features:376 - Char n-gram features shape: (50, 100)
2026-02-20 03:29:15.465 | INFO     | __main__:main:1151 -   Working subset size: 50
2026-02-20 03:29:15.465 | INFO     | __main__:main:1156 -   Computing CRND scores...
2026-02-20 03:29:15.565 | INFO     | __main__:main:1159 -   Computing label entropy (kDN per space)...
2026-02-20 03:29:15.641 | INFO     | __main__:main:1165 -   Computing cleanlab scores...
2026-02-20 03:29:17.823 | INFO     | __main__:main:1170 -   Computing WANN-adapted scores...
2026-02-20 03:29:17.937 | INFO     | __main__:main:1173 -   Computing cartography proxy scores...
2026-02-20 03:29:26.252 | INFO     | __main__:main:1176 -   Computing hybrid scores (H1-H4)...
2026-02-20 03:29:26.253 | INFO     | __main__:main:1182 -   Running noise injection evaluation...
2026-02-20 03:29:27.364 | INFO     | __main__:main:1224 -   Running significance tests...
2026-02-20 03:29:36.476 | INFO     | __main__:main:1242 -   Running quadrant analysis...
2026-02-20 03:29:36.477 | INFO     | __main__:main:1254 -   Computing Schoener's D niche overlap...
2026-02-20 03:30:03.841 | INFO     | __main__:main:1262 -   Per-class CRND analysis...
2026-02-20 03:30:03.843 | INFO     | __main__:main:1268 -   Testing niche overlap → classifier prediction...
2026-02-20 03:30:07.961 | INFO     | __main__:main:1309 -   Building per-instance output...
2026-02-20 03:30:07.969 | INFO     | __main__:main:1376 -   medical_abstracts completed in 57s (50 examples)
2026-02-20 03:30:08.166 | INFO     | __main__:main:1087 - === [2/5] Processing mimic_iv_ed_demo (N=50) ===
2026-02-20 03:30:08.166 | INFO     | __main__:main:1092 -   Classes (1): ['ESI-2']
2026-02-20 03:30:08.166 | INFO     | __main__:main:1097 -   Building TF-IDF features...
2026-02-20 03:30:08.169 | DEBUG    | __main__:build_tfidf_features:195 - TF-IDF shape: (50, 100)
2026-02-20 03:30:08.169 | INFO     | __main__:main:1100 -   Building sentence embeddings...
2026-02-20 03:30:09.766 | DEBUG    | __main__:main:1102 -   Embeddings shape: (50, 384)
2026-02-20 03:30:09.766 | INFO     | __main__:main:1127 -   Building char n-gram features (fallback for LLM)...
2026-02-20 03:30:09.773 | DEBUG    | __main__:build_doc2vec_features:376 - Char n-gram features shape: (50, 100)
2026-02-20 03:30:09.773 | INFO     | __main__:main:1151 -   Working subset size: 50
2026-02-20 03:30:09.788 | INFO     | __main__:main:1156 -   Computing CRND scores...
2026-02-20 03:30:10.047 | INFO     | __main__:main:1159 -   Computing label entropy (kDN per space)...
2026-02-20 03:30:10.249 | INFO     | __main__:main:1165 -   Computing cleanlab scores...
2026-02-20 03:30:10.262 | WARNING  | __main__:compute_cleanlab_scores:474 - cross_val_predict failed — returning uniform scores
2026-02-20 03:30:10.264 | WARNING  | __main__:compute_cleanlab_scores:474 - cross_val_predict failed — returning uniform scores
2026-02-20 03:30:10.267 | INFO     | __main__:main:1170 -   Computing WANN-adapted scores...
2026-02-20 03:30:10.392 | INFO     | __main__:main:1173 -   Computing cartography proxy scores...
2026-02-20 03:30:10.414 | WARNING  | __main__:compute_cartography_proxy:552 - Cartography CV round 0 failed
2026-02-20 03:30:10.416 | WARNING  | __main__:compute_cartography_proxy:552 - Cartography CV round 1 failed
2026-02-20 03:30:10.418 | WARNING  | __main__:compute_cartography_proxy:552 - Cartography CV round 2 failed
2026-02-20 03:30:10.419 | WARNING  | __main__:compute_cartography_proxy:552 - Cartography CV round 3 failed
2026-02-20 03:30:10.421 | WARNING  | __main__:compute_cartography_proxy:552 - Cartography CV round 4 failed
2026-02-20 03:30:10.421 | INFO     | __main__:main:1176 -   Computing hybrid scores (H1-H4)...
2026-02-20 03:30:10.421 | INFO     | __main__:main:1182 -   Running noise injection evaluation...
2026-02-20 03:30:10.964 | INFO     | __main__:main:1224 -   Running significance tests...
2026-02-20 03:30:20.459 | INFO     | __main__:main:1242 -   Running quadrant analysis...
2026-02-20 03:30:20.460 | INFO     | __main__:main:1254 -   Computing Schoener's D niche overlap...
2026-02-20 03:30:20.460 | INFO     | __main__:main:1262 -   Per-class CRND analysis...
2026-02-20 03:30:20.460 | INFO     | __main__:main:1268 -   Testing niche overlap → classifier prediction...
2026-02-20 03:30:20.461 | INFO     | __main__:main:1309 -   Building per-instance output...
2026-02-20 03:30:20.461 | INFO     | __main__:main:1376 -   mimic_iv_ed_demo completed in 12s (50 examples)
2026-02-20 03:30:20.593 | INFO     | __main__:main:1087 - === [3/5] Processing ohsumed_single (N=50) ===
2026-02-20 03:30:20.595 | INFO     | __main__:main:1092 -   Classes (1): ['Bacterial_Infections_and_Mycoses']
2026-02-20 03:30:20.595 | INFO     | __main__:main:1097 -   Building TF-IDF features...
2026-02-20 03:30:20.617 | DEBUG    | __main__:build_tfidf_features:195 - TF-IDF shape: (50, 100)
2026-02-20 03:30:20.618 | INFO     | __main__:main:1100 -   Building sentence embeddings...
2026-02-20 03:30:24.018 | DEBUG    | __main__:main:1102 -   Embeddings shape: (50, 384)
2026-02-20 03:30:24.018 | INFO     | __main__:main:1127 -   Building char n-gram features (fallback for LLM)...
2026-02-20 03:30:24.131 | DEBUG    | __main__:build_doc2vec_features:376 - Char n-gram features shape: (50, 100)
2026-02-20 03:30:24.131 | INFO     | __main__:main:1151 -   Working subset size: 50
2026-02-20 03:30:24.131 | INFO     | __main__:main:1156 -   Computing CRND scores...
2026-02-20 03:30:24.219 | INFO     | __main__:main:1159 -   Computing label entropy (kDN per space)...
2026-02-20 03:30:24.276 | INFO     | __main__:main:1165 -   Computing cleanlab scores...
2026-02-20 03:30:24.278 | WARNING  | __main__:compute_cleanlab_scores:474 - cross_val_predict failed — returning uniform scores
2026-02-20 03:30:24.280 | WARNING  | __main__:compute_cleanlab_scores:474 - cross_val_predict failed — returning uniform scores
2026-02-20 03:30:24.280 | INFO     | __main__:main:1170 -   Computing WANN-adapted scores...
2026-02-20 03:30:24.334 | INFO     | __main__:main:1173 -   Computing cartography proxy scores...
2026-02-20 03:30:24.337 | WARNING  | __main__:compute_cartography_proxy:552 - Cartography CV round 0 failed
2026-02-20 03:30:24.338 | WARNING  | __main__:compute_cartography_proxy:552 - Cartography CV round 1 failed
2026-02-20 03:30:24.340 | WARNING  | __main__:compute_cartography_proxy:552 - Cartography CV round 2 failed
2026-02-20 03:30:24.351 | WARNING  | __main__:compute_cartography_proxy:552 - Cartography CV round 3 failed
2026-02-20 03:30:24.353 | WARNING  | __main__:compute_cartography_proxy:552 - Cartography CV round 4 failed
2026-02-20 03:30:24.353 | INFO     | __main__:main:1176 -   Computing hybrid scores (H1-H4)...
2026-02-20 03:30:24.354 | INFO     | __main__:main:1182 -   Running noise injection evaluation...
2026-02-20 03:30:24.742 | INFO     | __main__:main:1224 -   Running significance tests...
2026-02-20 03:30:31.674 | INFO     | __main__:main:1242 -   Running quadrant analysis...
2026-02-20 03:30:31.674 | INFO     | __main__:main:1254 -   Computing Schoener's D niche overlap...
2026-02-20 03:30:31.674 | INFO     | __main__:main:1262 -   Per-class CRND analysis...
2026-02-20 03:30:31.674 | INFO     | __main__:main:1268 -   Testing niche overlap → classifier prediction...
2026-02-20 03:30:31.675 | INFO     | __main__:main:1309 -   Building per-instance output...
2026-02-20 03:30:31.676 | INFO     | __main__:main:1376 -   ohsumed_single completed in 11s (50 examples)
2026-02-20 03:30:31.795 | INFO     | __main__:main:1087 - === [4/5] Processing mental_health_conditions (N=50) ===
2026-02-20 03:30:31.795 | INFO     | __main__:main:1092 -   Classes (7): ['anxiety', 'bipolar', 'depression', 'normal', 'personality disorder', 'stress', 'suicidal']
2026-02-20 03:30:31.795 | INFO     | __main__:main:1097 -   Building TF-IDF features...
2026-02-20 03:30:31.801 | DEBUG    | __main__:build_tfidf_features:195 - TF-IDF shape: (50, 100)
2026-02-20 03:30:31.801 | INFO     | __main__:main:1100 -   Building sentence embeddings...
2026-02-20 03:30:34.751 | DEBUG    | __main__:main:1102 -   Embeddings shape: (50, 384)
2026-02-20 03:30:34.751 | INFO     | __main__:main:1127 -   Building char n-gram features (fallback for LLM)...
2026-02-20 03:30:34.783 | DEBUG    | __main__:build_doc2vec_features:376 - Char n-gram features shape: (50, 100)
2026-02-20 03:30:34.783 | INFO     | __main__:main:1151 -   Working subset size: 50
2026-02-20 03:30:34.783 | INFO     | __main__:main:1156 -   Computing CRND scores...
2026-02-20 03:30:34.815 | INFO     | __main__:main:1159 -   Computing label entropy (kDN per space)...
2026-02-20 03:30:34.932 | INFO     | __main__:main:1165 -   Computing cleanlab scores...
2026-02-20 03:30:35.676 | INFO     | __main__:main:1170 -   Computing WANN-adapted scores...
2026-02-20 03:30:35.776 | INFO     | __main__:main:1173 -   Computing cartography proxy scores...
2026-02-20 03:30:37.265 | INFO     | __main__:main:1176 -   Computing hybrid scores (H1-H4)...
2026-02-20 03:30:37.266 | INFO     | __main__:main:1182 -   Running noise injection evaluation...
2026-02-20 03:30:37.735 | INFO     | __main__:main:1224 -   Running significance tests...
2026-02-20 03:30:45.434 | INFO     | __main__:main:1242 -   Running quadrant analysis...
2026-02-20 03:30:45.435 | INFO     | __main__:main:1254 -   Computing Schoener's D niche overlap...
2026-02-20 03:31:30.547 | INFO     | __main__:main:1262 -   Per-class CRND analysis...
2026-02-20 03:31:30.549 | INFO     | __main__:main:1268 -   Testing niche overlap → classifier prediction...
2026-02-20 03:31:31.596 | INFO     | __main__:main:1309 -   Building per-instance output...
2026-02-20 03:31:31.597 | INFO     | __main__:main:1376 -   mental_health_conditions completed in 60s (50 examples)
2026-02-20 03:31:31.776 | INFO     | __main__:main:1087 - === [5/5] Processing medical_transcriptions (N=50) ===
2026-02-20 03:31:31.777 | INFO     | __main__:main:1092 -   Classes (4): ['cardiovascular_pulmonary', 'internal_medicine', 'neurology_psychiatry', 'surgical']
2026-02-20 03:31:31.777 | INFO     | __main__:main:1097 -   Building TF-IDF features...
2026-02-20 03:31:31.815 | DEBUG    | __main__:build_tfidf_features:195 - TF-IDF shape: (50, 100)
2026-02-20 03:31:31.816 | INFO     | __main__:main:1100 -   Building sentence embeddings...
2026-02-20 03:31:38.646 | DEBUG    | __main__:main:1102 -   Embeddings shape: (50, 384)
2026-02-20 03:31:38.647 | INFO     | __main__:main:1127 -   Building char n-gram features (fallback for LLM)...
2026-02-20 03:31:38.877 | DEBUG    | __main__:build_doc2vec_features:376 - Char n-gram features shape: (50, 100)
2026-02-20 03:31:38.877 | INFO     | __main__:main:1151 -   Working subset size: 50
2026-02-20 03:31:38.877 | INFO     | __main__:main:1156 -   Computing CRND scores...
2026-02-20 03:31:39.031 | INFO     | __main__:main:1159 -   Computing label entropy (kDN per space)...
2026-02-20 03:31:39.173 | INFO     | __main__:main:1165 -   Computing cleanlab scores...
2026-02-20 03:31:40.117 | INFO     | __main__:main:1170 -   Computing WANN-adapted scores...
2026-02-20 03:31:40.290 | INFO     | __main__:main:1173 -   Computing cartography proxy scores...
2026-02-20 03:31:42.941 | INFO     | __main__:main:1176 -   Computing hybrid scores (H1-H4)...
2026-02-20 03:31:42.942 | INFO     | __main__:main:1182 -   Running noise injection evaluation...
2026-02-20 03:31:43.515 | INFO     | __main__:main:1224 -   Running significance tests...
2026-02-20 03:31:51.647 | INFO     | __main__:main:1242 -   Running quadrant analysis...
2026-02-20 03:31:51.649 | INFO     | __main__:main:1254 -   Computing Schoener's D niche overlap...
2026-02-20 03:31:54.050 | INFO     | __main__:main:1262 -   Per-class CRND analysis...
2026-02-20 03:31:54.061 | INFO     | __main__:main:1268 -   Testing niche overlap → classifier prediction...
2026-02-20 03:31:55.311 | INFO     | __main__:main:1309 -   Building per-instance output...
2026-02-20 03:31:55.313 | INFO     | __main__:main:1376 -   medical_transcriptions completed in 24s (50 examples)
2026-02-20 03:31:55.481 | SUCCESS  | __main__:main:1415 - Saved method_out.json (250 examples across 5 datasets) in 173s
2026-02-20 03:31:55.481 | INFO     | __main__:main:1419 - LLM calls: 0, cost: $0.000
2026-02-20 03:32:34.672 | INFO     | __main__:load_and_prepare_datasets:143 - Skipping clinical_patient_triage_nl (N=31, too small for k-NN)
2026-02-20 03:32:34.998 | WARNING  | __main__:load_and_prepare_datasets:146 - Duplicate dataset 'medical_abstracts' — keeping first occurrence
2026-02-20 03:32:35.013 | INFO     | __main__:load_and_prepare_datasets:167 - medical_abstracts: trimmed to 50/14438
2026-02-20 03:32:35.014 | INFO     | __main__:load_and_prepare_datasets:167 - mimic_iv_ed_demo: trimmed to 50/207
2026-02-20 03:32:35.020 | INFO     | __main__:load_and_prepare_datasets:167 - ohsumed_single: trimmed to 50/7400
2026-02-20 03:32:35.027 | INFO     | __main__:load_and_prepare_datasets:167 - mental_health_conditions: trimmed to 50/15000
2026-02-20 03:32:35.029 | INFO     | __main__:load_and_prepare_datasets:167 - medical_transcriptions: trimmed to 50/4966
2026-02-20 03:32:35.040 | INFO     | __main__:load_and_prepare_datasets:183 - medical_abstracts: using all 50
2026-02-20 03:32:35.040 | INFO     | __main__:load_and_prepare_datasets:183 - mimic_iv_ed_demo: using all 50
2026-02-20 03:32:35.040 | INFO     | __main__:load_and_prepare_datasets:183 - ohsumed_single: using all 50
2026-02-20 03:32:35.040 | INFO     | __main__:load_and_prepare_datasets:183 - mental_health_conditions: using all 50
2026-02-20 03:32:35.040 | INFO     | __main__:load_and_prepare_datasets:183 - medical_transcriptions: using all 50
2026-02-20 03:32:35.044 | INFO     | __main__:main:1083 - Loaded 5 datasets: ['medical_abstracts', 'mimic_iv_ed_demo', 'ohsumed_single', 'mental_health_conditions', 'medical_transcriptions']
2026-02-20 03:32:43.165 | INFO     | __main__:main:1095 - === [1/5] Processing medical_abstracts (N=50) ===
2026-02-20 03:32:43.165 | INFO     | __main__:main:1100 -   Classes (5): ['Cardiovascular_diseases', 'Digestive_system_diseases', 'General_pathological_conditions', 'Neoplasms', 'Nervous_system_diseases']
2026-02-20 03:32:43.165 | INFO     | __main__:main:1105 -   Building TF-IDF features...
2026-02-20 03:32:43.186 | DEBUG    | __main__:build_tfidf_features:203 - TF-IDF shape: (50, 100)
2026-02-20 03:32:43.186 | INFO     | __main__:main:1108 -   Building sentence embeddings...
2026-02-20 03:32:47.358 | DEBUG    | __main__:main:1110 -   Embeddings shape: (50, 384)
2026-02-20 03:32:47.359 | INFO     | __main__:main:1135 -   Building char n-gram features (fallback for LLM)...
2026-02-20 03:32:47.450 | DEBUG    | __main__:build_doc2vec_features:384 - Char n-gram features shape: (50, 100)
2026-02-20 03:32:47.450 | INFO     | __main__:main:1159 -   Working subset size: 50
2026-02-20 03:32:47.451 | INFO     | __main__:main:1164 -   Computing CRND scores...
2026-02-20 03:32:47.547 | INFO     | __main__:main:1167 -   Computing label entropy (kDN per space)...
2026-02-20 03:32:47.638 | INFO     | __main__:main:1173 -   Computing cleanlab scores...
2026-02-20 03:32:49.853 | INFO     | __main__:main:1178 -   Computing WANN-adapted scores...
2026-02-20 03:32:50.028 | INFO     | __main__:main:1181 -   Computing cartography proxy scores...
2026-02-20 03:32:53.679 | INFO     | __main__:main:1184 -   Computing hybrid scores (H1-H4)...
2026-02-20 03:32:53.679 | INFO     | __main__:main:1190 -   Running noise injection evaluation...
2026-02-20 03:32:54.211 | INFO     | __main__:main:1232 -   Running significance tests...
2026-02-20 03:33:02.930 | INFO     | __main__:main:1250 -   Running quadrant analysis...
2026-02-20 03:33:02.931 | INFO     | __main__:main:1262 -   Computing Schoener's D niche overlap...
2026-02-20 03:33:17.409 | INFO     | __main__:main:1270 -   Per-class CRND analysis...
2026-02-20 03:33:17.411 | INFO     | __main__:main:1276 -   Testing niche overlap → classifier prediction...
2026-02-20 03:33:20.036 | INFO     | __main__:main:1317 -   Building per-instance output...
2026-02-20 03:33:20.037 | INFO     | __main__:main:1384 -   medical_abstracts completed in 37s (50 examples)
2026-02-20 03:33:20.211 | INFO     | __main__:main:1095 - === [2/5] Processing mimic_iv_ed_demo (N=50) ===
2026-02-20 03:33:20.211 | INFO     | __main__:main:1100 -   Classes (4): ['ESI-1', 'ESI-2', 'ESI-3', 'ESI-4']
2026-02-20 03:33:20.211 | INFO     | __main__:main:1105 -   Building TF-IDF features...
2026-02-20 03:33:20.215 | DEBUG    | __main__:build_tfidf_features:203 - TF-IDF shape: (50, 100)
2026-02-20 03:33:20.215 | INFO     | __main__:main:1108 -   Building sentence embeddings...
2026-02-20 03:33:21.002 | DEBUG    | __main__:main:1110 -   Embeddings shape: (50, 384)
2026-02-20 03:33:21.002 | INFO     | __main__:main:1135 -   Building char n-gram features (fallback for LLM)...
2026-02-20 03:33:21.012 | DEBUG    | __main__:build_doc2vec_features:384 - Char n-gram features shape: (50, 100)
2026-02-20 03:33:21.013 | INFO     | __main__:main:1159 -   Working subset size: 50
2026-02-20 03:33:21.013 | INFO     | __main__:main:1164 -   Computing CRND scores...
2026-02-20 03:33:21.123 | INFO     | __main__:main:1167 -   Computing label entropy (kDN per space)...
2026-02-20 03:33:21.205 | INFO     | __main__:main:1173 -   Computing cleanlab scores...
2026-02-20 03:33:22.148 | INFO     | __main__:main:1178 -   Computing WANN-adapted scores...
2026-02-20 03:33:22.243 | INFO     | __main__:main:1181 -   Computing cartography proxy scores...
2026-02-20 03:33:22.892 | INFO     | __main__:main:1184 -   Computing hybrid scores (H1-H4)...
2026-02-20 03:33:22.893 | INFO     | __main__:main:1190 -   Running noise injection evaluation...
2026-02-20 03:33:23.328 | INFO     | __main__:main:1232 -   Running significance tests...
2026-02-20 03:33:30.934 | INFO     | __main__:main:1250 -   Running quadrant analysis...
2026-02-20 03:33:30.935 | INFO     | __main__:main:1262 -   Computing Schoener's D niche overlap...
2026-02-20 03:33:40.467 | INFO     | __main__:main:1270 -   Per-class CRND analysis...
2026-02-20 03:33:40.483 | INFO     | __main__:main:1276 -   Testing niche overlap → classifier prediction...
2026-02-20 03:33:41.679 | INFO     | __main__:main:1317 -   Building per-instance output...
2026-02-20 03:33:41.680 | INFO     | __main__:main:1384 -   mimic_iv_ed_demo completed in 21s (50 examples)
2026-02-20 03:33:41.839 | INFO     | __main__:main:1095 - === [3/5] Processing ohsumed_single (N=50) ===
2026-02-20 03:33:41.840 | INFO     | __main__:main:1100 -   Classes (23): ['Animal_Diseases', 'Bacterial_Infections_and_Mycoses', 'Cardiovascular_Diseases', 'Digestive_System_Diseases', 'Disorders_of_Environmental_Origin', 'Endocrine_Diseases', 'Eye_Diseases', 'Female_Genital_Diseases_and_Pregnancy_Complications', 'Hemic_and_Lymphatic_Diseases', 'Immunologic_Diseases']
2026-02-20 03:33:41.840 | INFO     | __main__:main:1105 -   Building TF-IDF features...
2026-02-20 03:33:41.862 | DEBUG    | __main__:build_tfidf_features:203 - TF-IDF shape: (50, 100)
2026-02-20 03:33:41.862 | INFO     | __main__:main:1108 -   Building sentence embeddings...
2026-02-20 03:33:49.400 | DEBUG    | __main__:main:1110 -   Embeddings shape: (50, 384)
2026-02-20 03:33:49.400 | INFO     | __main__:main:1135 -   Building char n-gram features (fallback for LLM)...
2026-02-20 03:33:49.679 | DEBUG    | __main__:build_doc2vec_features:384 - Char n-gram features shape: (50, 100)
2026-02-20 03:33:49.679 | INFO     | __main__:main:1159 -   Working subset size: 50
2026-02-20 03:33:49.679 | INFO     | __main__:main:1164 -   Computing CRND scores...
2026-02-20 03:33:49.947 | INFO     | __main__:main:1167 -   Computing label entropy (kDN per space)...
2026-02-20 03:33:50.177 | INFO     | __main__:main:1173 -   Computing cleanlab scores...
2026-02-20 03:33:51.383 | INFO     | __main__:main:1178 -   Computing WANN-adapted scores...
2026-02-20 03:33:51.570 | INFO     | __main__:main:1181 -   Computing cartography proxy scores...
2026-02-20 03:33:53.138 | INFO     | __main__:main:1184 -   Computing hybrid scores (H1-H4)...
2026-02-20 03:33:53.139 | INFO     | __main__:main:1190 -   Running noise injection evaluation...
2026-02-20 03:33:53.822 | INFO     | __main__:main:1232 -   Running significance tests...
2026-02-20 03:34:05.128 | INFO     | __main__:main:1250 -   Running quadrant analysis...
2026-02-20 03:34:05.129 | INFO     | __main__:main:1262 -   Computing Schoener's D niche overlap...
2026-02-20 03:34:18.835 | INFO     | __main__:main:1270 -   Per-class CRND analysis...
2026-02-20 03:34:18.840 | INFO     | __main__:main:1276 -   Testing niche overlap → classifier prediction...
2026-02-20 03:34:19.208 | INFO     | __main__:main:1317 -   Building per-instance output...
2026-02-20 03:34:19.209 | INFO     | __main__:main:1384 -   ohsumed_single completed in 37s (50 examples)
2026-02-20 03:34:19.338 | INFO     | __main__:main:1095 - === [4/5] Processing mental_health_conditions (N=50) ===
2026-02-20 03:34:19.338 | INFO     | __main__:main:1100 -   Classes (7): ['anxiety', 'bipolar', 'depression', 'normal', 'personality disorder', 'stress', 'suicidal']
2026-02-20 03:34:19.338 | INFO     | __main__:main:1105 -   Building TF-IDF features...
2026-02-20 03:34:19.347 | DEBUG    | __main__:build_tfidf_features:203 - TF-IDF shape: (50, 100)
2026-02-20 03:34:19.347 | INFO     | __main__:main:1108 -   Building sentence embeddings...
2026-02-20 03:34:21.835 | DEBUG    | __main__:main:1110 -   Embeddings shape: (50, 384)
2026-02-20 03:34:21.836 | INFO     | __main__:main:1135 -   Building char n-gram features (fallback for LLM)...
2026-02-20 03:34:21.873 | DEBUG    | __main__:build_doc2vec_features:384 - Char n-gram features shape: (50, 100)
2026-02-20 03:34:21.873 | INFO     | __main__:main:1159 -   Working subset size: 50
2026-02-20 03:34:21.873 | INFO     | __main__:main:1164 -   Computing CRND scores...
2026-02-20 03:34:21.909 | INFO     | __main__:main:1167 -   Computing label entropy (kDN per space)...
2026-02-20 03:34:21.941 | INFO     | __main__:main:1173 -   Computing cleanlab scores...
2026-02-20 03:34:22.845 | INFO     | __main__:main:1178 -   Computing WANN-adapted scores...
2026-02-20 03:34:22.926 | INFO     | __main__:main:1181 -   Computing cartography proxy scores...
2026-02-20 03:34:24.895 | INFO     | __main__:main:1184 -   Computing hybrid scores (H1-H4)...
2026-02-20 03:34:24.896 | INFO     | __main__:main:1190 -   Running noise injection evaluation...
2026-02-20 03:34:25.355 | INFO     | __main__:main:1232 -   Running significance tests...
2026-02-20 03:34:32.338 | INFO     | __main__:main:1250 -   Running quadrant analysis...
2026-02-20 03:34:32.339 | INFO     | __main__:main:1262 -   Computing Schoener's D niche overlap...
2026-02-20 03:35:14.076 | INFO     | __main__:main:1270 -   Per-class CRND analysis...
2026-02-20 03:35:14.097 | INFO     | __main__:main:1276 -   Testing niche overlap → classifier prediction...
2026-02-20 03:35:16.945 | INFO     | __main__:main:1317 -   Building per-instance output...
2026-02-20 03:35:16.946 | INFO     | __main__:main:1384 -   mental_health_conditions completed in 58s (50 examples)
2026-02-20 03:35:17.106 | INFO     | __main__:main:1095 - === [5/5] Processing medical_transcriptions (N=50) ===
2026-02-20 03:35:17.107 | INFO     | __main__:main:1100 -   Classes (5): ['cardiovascular_pulmonary', 'internal_medicine', 'neurology_psychiatry', 'radiology_consults_obgyn', 'surgical']
2026-02-20 03:35:17.107 | INFO     | __main__:main:1105 -   Building TF-IDF features...
2026-02-20 03:35:17.147 | DEBUG    | __main__:build_tfidf_features:203 - TF-IDF shape: (50, 100)
2026-02-20 03:35:17.147 | INFO     | __main__:main:1108 -   Building sentence embeddings...
2026-02-20 03:35:20.823 | DEBUG    | __main__:main:1110 -   Embeddings shape: (50, 384)
2026-02-20 03:35:20.823 | INFO     | __main__:main:1135 -   Building char n-gram features (fallback for LLM)...
2026-02-20 03:35:21.034 | DEBUG    | __main__:build_doc2vec_features:384 - Char n-gram features shape: (50, 100)
2026-02-20 03:35:21.034 | INFO     | __main__:main:1159 -   Working subset size: 50
2026-02-20 03:35:21.034 | INFO     | __main__:main:1164 -   Computing CRND scores...
2026-02-20 03:35:21.082 | INFO     | __main__:main:1167 -   Computing label entropy (kDN per space)...
2026-02-20 03:35:21.122 | INFO     | __main__:main:1173 -   Computing cleanlab scores...
2026-02-20 03:35:21.923 | INFO     | __main__:main:1178 -   Computing WANN-adapted scores...
2026-02-20 03:35:22.042 | INFO     | __main__:main:1181 -   Computing cartography proxy scores...
2026-02-20 03:35:23.055 | INFO     | __main__:main:1184 -   Computing hybrid scores (H1-H4)...
2026-02-20 03:35:23.061 | INFO     | __main__:main:1190 -   Running noise injection evaluation...
2026-02-20 03:35:23.872 | INFO     | __main__:main:1232 -   Running significance tests...
2026-02-20 03:35:32.784 | INFO     | __main__:main:1250 -   Running quadrant analysis...
2026-02-20 03:35:32.785 | INFO     | __main__:main:1262 -   Computing Schoener's D niche overlap...
2026-02-20 03:35:39.337 | INFO     | __main__:main:1270 -   Per-class CRND analysis...
2026-02-20 03:35:39.338 | INFO     | __main__:main:1276 -   Testing niche overlap → classifier prediction...
2026-02-20 03:35:40.133 | INFO     | __main__:main:1317 -   Building per-instance output...
2026-02-20 03:35:40.134 | INFO     | __main__:main:1384 -   medical_transcriptions completed in 23s (50 examples)
2026-02-20 03:35:40.316 | SUCCESS  | __main__:main:1423 - Saved method_out.json (250 examples across 5 datasets) in 187s
2026-02-20 03:35:40.317 | INFO     | __main__:main:1427 - LLM calls: 0, cost: $0.000
2026-02-20 03:36:04.729 | INFO     | __main__:load_and_prepare_datasets:143 - Skipping clinical_patient_triage_nl (N=31, too small for k-NN)
2026-02-20 03:36:04.991 | WARNING  | __main__:load_and_prepare_datasets:146 - Duplicate dataset 'medical_abstracts' — keeping first occurrence
2026-02-20 03:36:05.002 | INFO     | __main__:load_and_prepare_datasets:167 - medical_abstracts: trimmed to 100/14438
2026-02-20 03:36:05.002 | INFO     | __main__:load_and_prepare_datasets:167 - mimic_iv_ed_demo: trimmed to 100/207
2026-02-20 03:36:05.008 | INFO     | __main__:load_and_prepare_datasets:167 - ohsumed_single: trimmed to 100/7400
2026-02-20 03:36:05.014 | INFO     | __main__:load_and_prepare_datasets:167 - mental_health_conditions: trimmed to 100/15000
2026-02-20 03:36:05.016 | INFO     | __main__:load_and_prepare_datasets:167 - medical_transcriptions: trimmed to 100/4966
2026-02-20 03:36:05.026 | INFO     | __main__:load_and_prepare_datasets:183 - medical_abstracts: using all 100
2026-02-20 03:36:05.026 | INFO     | __main__:load_and_prepare_datasets:183 - mimic_iv_ed_demo: using all 100
2026-02-20 03:36:05.026 | INFO     | __main__:load_and_prepare_datasets:183 - ohsumed_single: using all 100
2026-02-20 03:36:05.026 | INFO     | __main__:load_and_prepare_datasets:183 - mental_health_conditions: using all 100
2026-02-20 03:36:05.026 | INFO     | __main__:load_and_prepare_datasets:183 - medical_transcriptions: using all 100
2026-02-20 03:36:05.032 | INFO     | __main__:main:1083 - Loaded 5 datasets: ['medical_abstracts', 'mimic_iv_ed_demo', 'ohsumed_single', 'mental_health_conditions', 'medical_transcriptions']
2026-02-20 03:36:12.283 | INFO     | __main__:main:1095 - === [1/5] Processing medical_abstracts (N=100) ===
2026-02-20 03:36:12.284 | INFO     | __main__:main:1100 -   Classes (5): ['Cardiovascular_diseases', 'Digestive_system_diseases', 'General_pathological_conditions', 'Neoplasms', 'Nervous_system_diseases']
2026-02-20 03:36:12.284 | INFO     | __main__:main:1105 -   Building TF-IDF features...
2026-02-20 03:36:12.317 | DEBUG    | __main__:build_tfidf_features:203 - TF-IDF shape: (100, 200)
2026-02-20 03:36:12.318 | INFO     | __main__:main:1108 -   Building sentence embeddings...
2026-02-20 03:36:18.733 | DEBUG    | __main__:main:1110 -   Embeddings shape: (100, 384)
2026-02-20 03:36:18.733 | INFO     | __main__:main:1135 -   Building char n-gram features (fallback for LLM)...
2026-02-20 03:36:21.809 | DEBUG    | __main__:build_doc2vec_features:384 - Char n-gram features shape: (100, 100)
2026-02-20 03:36:21.809 | INFO     | __main__:main:1159 -   Working subset size: 100
2026-02-20 03:36:21.809 | INFO     | __main__:main:1164 -   Computing CRND scores...
2026-02-20 03:36:21.932 | INFO     | __main__:main:1167 -   Computing label entropy (kDN per space)...
2026-02-20 03:36:21.969 | INFO     | __main__:main:1173 -   Computing cleanlab scores...
2026-02-20 03:36:24.204 | INFO     | __main__:main:1178 -   Computing WANN-adapted scores...
2026-02-20 03:36:24.301 | INFO     | __main__:main:1181 -   Computing cartography proxy scores...
2026-02-20 03:36:32.053 | INFO     | __main__:main:1184 -   Computing hybrid scores (H1-H4)...
2026-02-20 03:36:32.053 | INFO     | __main__:main:1190 -   Running noise injection evaluation...
2026-02-20 03:36:32.889 | INFO     | __main__:main:1232 -   Running significance tests...
2026-02-20 03:36:42.189 | INFO     | __main__:main:1250 -   Running quadrant analysis...
2026-02-20 03:36:42.190 | INFO     | __main__:main:1262 -   Computing Schoener's D niche overlap...
2026-02-20 03:37:18.564 | INFO     | __main__:main:1270 -   Per-class CRND analysis...
2026-02-20 03:37:18.566 | INFO     | __main__:main:1276 -   Testing niche overlap → classifier prediction...
2026-02-20 03:37:20.752 | INFO     | __main__:main:1317 -   Building per-instance output...
2026-02-20 03:37:20.753 | INFO     | __main__:main:1384 -   medical_abstracts completed in 68s (100 examples)
2026-02-20 03:37:20.932 | INFO     | __main__:main:1095 - === [2/5] Processing mimic_iv_ed_demo (N=100) ===
2026-02-20 03:37:20.932 | INFO     | __main__:main:1100 -   Classes (4): ['ESI-1', 'ESI-2', 'ESI-3', 'ESI-4']
2026-02-20 03:37:20.933 | INFO     | __main__:main:1105 -   Building TF-IDF features...
2026-02-20 03:37:20.937 | DEBUG    | __main__:build_tfidf_features:203 - TF-IDF shape: (100, 200)
2026-02-20 03:37:20.937 | INFO     | __main__:main:1108 -   Building sentence embeddings...
2026-02-20 03:37:22.880 | DEBUG    | __main__:main:1110 -   Embeddings shape: (100, 384)
2026-02-20 03:37:22.880 | INFO     | __main__:main:1135 -   Building char n-gram features (fallback for LLM)...
2026-02-20 03:37:25.322 | DEBUG    | __main__:build_doc2vec_features:384 - Char n-gram features shape: (100, 100)
2026-02-20 03:37:25.322 | INFO     | __main__:main:1159 -   Working subset size: 100
2026-02-20 03:37:25.322 | INFO     | __main__:main:1164 -   Computing CRND scores...
2026-02-20 03:37:25.467 | INFO     | __main__:main:1167 -   Computing label entropy (kDN per space)...
2026-02-20 03:37:25.539 | INFO     | __main__:main:1173 -   Computing cleanlab scores...
2026-02-20 03:37:26.254 | INFO     | __main__:main:1178 -   Computing WANN-adapted scores...
2026-02-20 03:37:26.316 | INFO     | __main__:main:1181 -   Computing cartography proxy scores...
2026-02-20 03:37:28.472 | INFO     | __main__:main:1184 -   Computing hybrid scores (H1-H4)...
2026-02-20 03:37:28.473 | INFO     | __main__:main:1190 -   Running noise injection evaluation...
2026-02-20 03:37:28.927 | INFO     | __main__:main:1232 -   Running significance tests...
2026-02-20 03:37:36.502 | INFO     | __main__:main:1250 -   Running quadrant analysis...
2026-02-20 03:37:36.503 | INFO     | __main__:main:1262 -   Computing Schoener's D niche overlap...
2026-02-20 03:38:08.800 | INFO     | __main__:main:1270 -   Per-class CRND analysis...
2026-02-20 03:38:08.803 | INFO     | __main__:main:1276 -   Testing niche overlap → classifier prediction...
2026-02-20 03:38:11.068 | INFO     | __main__:main:1317 -   Building per-instance output...
2026-02-20 03:38:11.069 | INFO     | __main__:main:1384 -   mimic_iv_ed_demo completed in 50s (100 examples)
2026-02-20 03:38:11.260 | INFO     | __main__:main:1095 - === [3/5] Processing ohsumed_single (N=100) ===
2026-02-20 03:38:11.261 | INFO     | __main__:main:1100 -   Classes (23): ['Animal_Diseases', 'Bacterial_Infections_and_Mycoses', 'Cardiovascular_Diseases', 'Digestive_System_Diseases', 'Disorders_of_Environmental_Origin', 'Endocrine_Diseases', 'Eye_Diseases', 'Female_Genital_Diseases_and_Pregnancy_Complications', 'Hemic_and_Lymphatic_Diseases', 'Immunologic_Diseases']
2026-02-20 03:38:11.261 | INFO     | __main__:main:1105 -   Building TF-IDF features...
2026-02-20 03:38:11.306 | DEBUG    | __main__:build_tfidf_features:203 - TF-IDF shape: (100, 200)
2026-02-20 03:38:11.307 | INFO     | __main__:main:1108 -   Building sentence embeddings...
2026-02-20 03:38:17.389 | DEBUG    | __main__:main:1110 -   Embeddings shape: (100, 384)
2026-02-20 03:38:17.389 | INFO     | __main__:main:1135 -   Building char n-gram features (fallback for LLM)...
2026-02-20 03:38:20.764 | DEBUG    | __main__:build_doc2vec_features:384 - Char n-gram features shape: (100, 100)
2026-02-20 03:38:20.769 | INFO     | __main__:main:1159 -   Working subset size: 100
2026-02-20 03:38:20.771 | INFO     | __main__:main:1164 -   Computing CRND scores...
2026-02-20 03:38:21.072 | INFO     | __main__:main:1167 -   Computing label entropy (kDN per space)...
2026-02-20 03:38:21.230 | INFO     | __main__:main:1173 -   Computing cleanlab scores...
2026-02-20 03:38:22.665 | INFO     | __main__:main:1178 -   Computing WANN-adapted scores...
2026-02-20 03:38:22.780 | INFO     | __main__:main:1181 -   Computing cartography proxy scores...
2026-02-20 03:38:24.353 | INFO     | __main__:main:1184 -   Computing hybrid scores (H1-H4)...
2026-02-20 03:38:24.354 | INFO     | __main__:main:1190 -   Running noise injection evaluation...
2026-02-20 03:38:24.861 | INFO     | __main__:main:1232 -   Running significance tests...
2026-02-20 03:38:31.846 | INFO     | __main__:main:1250 -   Running quadrant analysis...
2026-02-20 03:38:31.846 | INFO     | __main__:main:1262 -   Computing Schoener's D niche overlap...
2026-02-20 03:46:23.202 | INFO     | __main__:main:1270 -   Per-class CRND analysis...
2026-02-20 03:46:23.207 | INFO     | __main__:main:1276 -   Testing niche overlap → classifier prediction...
2026-02-20 03:46:24.016 | INFO     | __main__:main:1317 -   Building per-instance output...
2026-02-20 03:46:24.022 | INFO     | __main__:main:1384 -   ohsumed_single completed in 493s (100 examples)
2026-02-20 03:46:24.189 | INFO     | __main__:main:1095 - === [4/5] Processing mental_health_conditions (N=100) ===
2026-02-20 03:46:24.190 | INFO     | __main__:main:1100 -   Classes (7): ['anxiety', 'bipolar', 'depression', 'normal', 'personality disorder', 'stress', 'suicidal']
2026-02-20 03:46:24.190 | INFO     | __main__:main:1105 -   Building TF-IDF features...
2026-02-20 03:46:24.201 | DEBUG    | __main__:build_tfidf_features:203 - TF-IDF shape: (100, 200)
2026-02-20 03:46:24.201 | INFO     | __main__:main:1108 -   Building sentence embeddings...
2026-02-20 03:46:27.961 | DEBUG    | __main__:main:1110 -   Embeddings shape: (100, 384)
2026-02-20 03:46:27.962 | INFO     | __main__:main:1135 -   Building char n-gram features (fallback for LLM)...
2026-02-20 03:46:28.048 | DEBUG    | __main__:build_doc2vec_features:384 - Char n-gram features shape: (100, 100)
2026-02-20 03:46:28.048 | INFO     | __main__:main:1159 -   Working subset size: 100
2026-02-20 03:46:28.048 | INFO     | __main__:main:1164 -   Computing CRND scores...
2026-02-20 03:46:28.151 | INFO     | __main__:main:1167 -   Computing label entropy (kDN per space)...
2026-02-20 03:46:28.156 | INFO     | __main__:main:1173 -   Computing cleanlab scores...
2026-02-20 03:46:28.969 | INFO     | __main__:main:1178 -   Computing WANN-adapted scores...
2026-02-20 03:46:29.047 | INFO     | __main__:main:1181 -   Computing cartography proxy scores...
2026-02-20 03:46:31.206 | INFO     | __main__:main:1184 -   Computing hybrid scores (H1-H4)...
2026-02-20 03:46:31.207 | INFO     | __main__:main:1190 -   Running noise injection evaluation...
2026-02-20 03:46:31.603 | INFO     | __main__:main:1232 -   Running significance tests...
2026-02-20 03:46:37.975 | INFO     | __main__:main:1250 -   Running quadrant analysis...
2026-02-20 03:46:37.975 | INFO     | __main__:main:1262 -   Computing Schoener's D niche overlap...
2026-02-20 03:48:06.850 | INFO     | __main__:main:1270 -   Per-class CRND analysis...
2026-02-20 03:48:06.852 | INFO     | __main__:main:1276 -   Testing niche overlap → classifier prediction...
2026-02-20 03:48:09.323 | INFO     | __main__:main:1317 -   Building per-instance output...
2026-02-20 03:48:09.337 | INFO     | __main__:main:1384 -   mental_health_conditions completed in 105s (100 examples)
2026-02-20 03:48:09.481 | INFO     | __main__:main:1095 - === [5/5] Processing medical_transcriptions (N=100) ===
2026-02-20 03:48:09.482 | INFO     | __main__:main:1100 -   Classes (5): ['cardiovascular_pulmonary', 'internal_medicine', 'neurology_psychiatry', 'radiology_consults_obgyn', 'surgical']
2026-02-20 03:48:09.482 | INFO     | __main__:main:1105 -   Building TF-IDF features...
2026-02-20 03:48:09.563 | DEBUG    | __main__:build_tfidf_features:203 - TF-IDF shape: (100, 200)
2026-02-20 03:48:09.563 | INFO     | __main__:main:1108 -   Building sentence embeddings...
2026-02-20 03:48:14.090 | DEBUG    | __main__:main:1110 -   Embeddings shape: (100, 384)
2026-02-20 03:48:14.090 | INFO     | __main__:main:1135 -   Building char n-gram features (fallback for LLM)...
2026-02-20 03:48:15.411 | DEBUG    | __main__:build_doc2vec_features:384 - Char n-gram features shape: (100, 100)
2026-02-20 03:48:15.411 | INFO     | __main__:main:1159 -   Working subset size: 100
2026-02-20 03:48:15.411 | INFO     | __main__:main:1164 -   Computing CRND scores...
2026-02-20 03:48:15.505 | INFO     | __main__:main:1167 -   Computing label entropy (kDN per space)...
2026-02-20 03:48:15.516 | INFO     | __main__:main:1173 -   Computing cleanlab scores...
2026-02-20 03:48:16.915 | INFO     | __main__:main:1178 -   Computing WANN-adapted scores...
2026-02-20 03:48:17.012 | INFO     | __main__:main:1181 -   Computing cartography proxy scores...
2026-02-20 03:48:19.824 | INFO     | __main__:main:1184 -   Computing hybrid scores (H1-H4)...
2026-02-20 03:48:19.825 | INFO     | __main__:main:1190 -   Running noise injection evaluation...
2026-02-20 03:48:20.246 | INFO     | __main__:main:1232 -   Running significance tests...
2026-02-20 03:48:26.994 | INFO     | __main__:main:1250 -   Running quadrant analysis...
2026-02-20 03:48:26.995 | INFO     | __main__:main:1262 -   Computing Schoener's D niche overlap...
2026-02-20 03:49:03.875 | INFO     | __main__:main:1270 -   Per-class CRND analysis...
2026-02-20 03:49:03.892 | INFO     | __main__:main:1276 -   Testing niche overlap → classifier prediction...
2026-02-20 03:49:07.403 | INFO     | __main__:main:1317 -   Building per-instance output...
2026-02-20 03:49:07.404 | INFO     | __main__:main:1384 -   medical_transcriptions completed in 58s (100 examples)
2026-02-20 03:49:07.606 | SUCCESS  | __main__:main:1423 - Saved method_out.json (500 examples across 5 datasets) in 784s
2026-02-20 03:49:07.606 | INFO     | __main__:main:1427 - LLM calls: 0, cost: $0.000
2026-02-20 03:49:37.758 | INFO     | __main__:load_and_prepare_datasets:143 - Skipping clinical_patient_triage_nl (N=31, too small for k-NN)
2026-02-20 03:49:38.036 | WARNING  | __main__:load_and_prepare_datasets:146 - Duplicate dataset 'medical_abstracts' — keeping first occurrence
2026-02-20 03:49:38.046 | INFO     | __main__:load_and_prepare_datasets:167 - medical_abstracts: trimmed to 200/14438
2026-02-20 03:49:38.047 | INFO     | __main__:load_and_prepare_datasets:167 - mimic_iv_ed_demo: trimmed to 200/207
2026-02-20 03:49:38.052 | INFO     | __main__:load_and_prepare_datasets:167 - ohsumed_single: trimmed to 200/7400
2026-02-20 03:49:38.058 | INFO     | __main__:load_and_prepare_datasets:167 - mental_health_conditions: trimmed to 200/15000
2026-02-20 03:49:38.060 | INFO     | __main__:load_and_prepare_datasets:167 - medical_transcriptions: trimmed to 200/4966
2026-02-20 03:49:38.070 | INFO     | __main__:load_and_prepare_datasets:183 - medical_abstracts: using all 200
2026-02-20 03:49:38.070 | INFO     | __main__:load_and_prepare_datasets:183 - mimic_iv_ed_demo: using all 200
2026-02-20 03:49:38.070 | INFO     | __main__:load_and_prepare_datasets:183 - ohsumed_single: using all 200
2026-02-20 03:49:38.070 | INFO     | __main__:load_and_prepare_datasets:183 - mental_health_conditions: using all 200
2026-02-20 03:49:38.070 | INFO     | __main__:load_and_prepare_datasets:183 - medical_transcriptions: using all 200
2026-02-20 03:49:38.075 | INFO     | __main__:main:1083 - Loaded 5 datasets: ['medical_abstracts', 'mimic_iv_ed_demo', 'ohsumed_single', 'mental_health_conditions', 'medical_transcriptions']
2026-02-20 03:49:44.571 | INFO     | __main__:main:1095 - === [1/5] Processing medical_abstracts (N=200) ===
2026-02-20 03:49:44.572 | INFO     | __main__:main:1100 -   Classes (5): ['Cardiovascular_diseases', 'Digestive_system_diseases', 'General_pathological_conditions', 'Neoplasms', 'Nervous_system_diseases']
2026-02-20 03:49:44.572 | INFO     | __main__:main:1105 -   Building TF-IDF features...
2026-02-20 03:49:44.618 | DEBUG    | __main__:build_tfidf_features:203 - TF-IDF shape: (200, 400)
2026-02-20 03:49:44.618 | INFO     | __main__:main:1108 -   Building sentence embeddings...
2026-02-20 03:49:53.188 | DEBUG    | __main__:main:1110 -   Embeddings shape: (200, 384)
2026-02-20 03:49:53.189 | INFO     | __main__:main:1135 -   Building char n-gram features (fallback for LLM)...
2026-02-20 03:49:53.837 | DEBUG    | __main__:build_doc2vec_features:384 - Char n-gram features shape: (200, 100)
2026-02-20 03:49:53.838 | INFO     | __main__:main:1159 -   Working subset size: 200
2026-02-20 03:49:53.838 | INFO     | __main__:main:1164 -   Computing CRND scores...
2026-02-20 03:49:53.983 | INFO     | __main__:main:1167 -   Computing label entropy (kDN per space)...
2026-02-20 03:49:54.126 | INFO     | __main__:main:1173 -   Computing cleanlab scores...
2026-02-20 03:49:55.532 | INFO     | __main__:main:1178 -   Computing WANN-adapted scores...
2026-02-20 03:49:55.636 | INFO     | __main__:main:1181 -   Computing cartography proxy scores...
2026-02-20 03:50:00.339 | INFO     | __main__:main:1184 -   Computing hybrid scores (H1-H4)...
2026-02-20 03:50:00.343 | INFO     | __main__:main:1190 -   Running noise injection evaluation...
2026-02-20 03:50:00.786 | INFO     | __main__:main:1232 -   Running significance tests...
2026-02-20 03:50:08.484 | INFO     | __main__:main:1250 -   Running quadrant analysis...
2026-02-20 03:50:08.485 | INFO     | __main__:main:1262 -   Computing Schoener's D niche overlap...
2026-02-20 03:51:27.634 | INFO     | __main__:main:1270 -   Per-class CRND analysis...
2026-02-20 03:51:27.636 | INFO     | __main__:main:1276 -   Testing niche overlap → classifier prediction...
2026-02-20 03:51:31.749 | INFO     | __main__:main:1317 -   Building per-instance output...
2026-02-20 03:51:31.751 | INFO     | __main__:main:1384 -   medical_abstracts completed in 107s (200 examples)
2026-02-20 03:51:31.954 | INFO     | __main__:main:1095 - === [2/5] Processing mimic_iv_ed_demo (N=200) ===
2026-02-20 03:51:31.954 | INFO     | __main__:main:1100 -   Classes (4): ['ESI-1', 'ESI-2', 'ESI-3', 'ESI-4']
2026-02-20 03:51:31.955 | INFO     | __main__:main:1105 -   Building TF-IDF features...
2026-02-20 03:51:31.961 | DEBUG    | __main__:build_tfidf_features:203 - TF-IDF shape: (200, 400)
2026-02-20 03:51:31.962 | INFO     | __main__:main:1108 -   Building sentence embeddings...
2026-02-20 03:51:34.747 | DEBUG    | __main__:main:1110 -   Embeddings shape: (200, 384)
2026-02-20 03:51:34.748 | INFO     | __main__:main:1135 -   Building char n-gram features (fallback for LLM)...
2026-02-20 03:51:38.825 | DEBUG    | __main__:build_doc2vec_features:384 - Char n-gram features shape: (200, 100)
2026-02-20 03:51:38.846 | INFO     | __main__:main:1159 -   Working subset size: 200
2026-02-20 03:51:38.892 | INFO     | __main__:main:1164 -   Computing CRND scores...
2026-02-20 03:51:39.122 | INFO     | __main__:main:1167 -   Computing label entropy (kDN per space)...
2026-02-20 03:51:39.226 | INFO     | __main__:main:1173 -   Computing cleanlab scores...
2026-02-20 03:51:42.320 | INFO     | __main__:main:1178 -   Computing WANN-adapted scores...
2026-02-20 03:51:42.430 | INFO     | __main__:main:1181 -   Computing cartography proxy scores...
2026-02-20 03:51:46.130 | INFO     | __main__:main:1184 -   Computing hybrid scores (H1-H4)...
2026-02-20 03:51:46.131 | INFO     | __main__:main:1190 -   Running noise injection evaluation...
2026-02-20 03:51:46.647 | INFO     | __main__:main:1232 -   Running significance tests...
2026-02-20 03:51:53.433 | INFO     | __main__:main:1250 -   Running quadrant analysis...
2026-02-20 03:51:53.434 | INFO     | __main__:main:1262 -   Computing Schoener's D niche overlap...
2026-02-20 03:52:01.817 | INFO     | __main__:main:1270 -   Per-class CRND analysis...
2026-02-20 03:52:01.819 | INFO     | __main__:main:1276 -   Testing niche overlap → classifier prediction...
2026-02-20 03:52:02.693 | INFO     | __main__:main:1317 -   Building per-instance output...
2026-02-20 03:52:02.695 | INFO     | __main__:main:1384 -   mimic_iv_ed_demo completed in 31s (200 examples)
2026-02-20 03:52:02.820 | INFO     | __main__:main:1095 - === [3/5] Processing ohsumed_single (N=200) ===
2026-02-20 03:52:02.821 | INFO     | __main__:main:1100 -   Classes (23): ['Animal_Diseases', 'Bacterial_Infections_and_Mycoses', 'Cardiovascular_Diseases', 'Digestive_System_Diseases', 'Disorders_of_Environmental_Origin', 'Endocrine_Diseases', 'Eye_Diseases', 'Female_Genital_Diseases_and_Pregnancy_Complications', 'Hemic_and_Lymphatic_Diseases', 'Immunologic_Diseases']
2026-02-20 03:52:02.821 | INFO     | __main__:main:1105 -   Building TF-IDF features...
2026-02-20 03:52:02.875 | DEBUG    | __main__:build_tfidf_features:203 - TF-IDF shape: (200, 400)
2026-02-20 03:52:02.875 | INFO     | __main__:main:1108 -   Building sentence embeddings...
2026-02-20 03:52:11.674 | DEBUG    | __main__:main:1110 -   Embeddings shape: (200, 384)
2026-02-20 03:52:11.674 | INFO     | __main__:main:1135 -   Building char n-gram features (fallback for LLM)...
2026-02-20 03:52:15.772 | DEBUG    | __main__:build_doc2vec_features:384 - Char n-gram features shape: (200, 100)
2026-02-20 03:52:15.772 | INFO     | __main__:main:1159 -   Working subset size: 200
2026-02-20 03:52:15.772 | INFO     | __main__:main:1164 -   Computing CRND scores...
2026-02-20 03:52:15.999 | INFO     | __main__:main:1167 -   Computing label entropy (kDN per space)...
2026-02-20 03:52:16.083 | INFO     | __main__:main:1173 -   Computing cleanlab scores...
2026-02-20 03:52:17.541 | INFO     | __main__:main:1178 -   Computing WANN-adapted scores...
2026-02-20 03:52:17.635 | INFO     | __main__:main:1181 -   Computing cartography proxy scores...
2026-02-20 03:52:21.306 | INFO     | __main__:main:1184 -   Computing hybrid scores (H1-H4)...
2026-02-20 03:52:21.307 | INFO     | __main__:main:1190 -   Running noise injection evaluation...
2026-02-20 03:52:21.754 | INFO     | __main__:main:1232 -   Running significance tests...
2026-02-20 03:52:28.250 | INFO     | __main__:main:1250 -   Running quadrant analysis...
2026-02-20 03:52:28.250 | INFO     | __main__:main:1262 -   Computing Schoener's D niche overlap...
2026-02-20 04:14:47.473 | INFO     | __main__:main:1270 -   Per-class CRND analysis...
2026-02-20 04:14:47.476 | INFO     | __main__:main:1276 -   Testing niche overlap → classifier prediction...
2026-02-20 04:14:49.465 | INFO     | __main__:main:1317 -   Building per-instance output...
2026-02-20 04:14:49.467 | INFO     | __main__:main:1384 -   ohsumed_single completed in 1367s (200 examples)
2026-02-20 04:14:49.605 | INFO     | __main__:main:1095 - === [4/5] Processing mental_health_conditions (N=200) ===
2026-02-20 04:14:49.606 | INFO     | __main__:main:1100 -   Classes (7): ['anxiety', 'bipolar', 'depression', 'normal', 'personality disorder', 'stress', 'suicidal']
2026-02-20 04:14:49.606 | INFO     | __main__:main:1105 -   Building TF-IDF features...
2026-02-20 04:14:49.637 | DEBUG    | __main__:build_tfidf_features:203 - TF-IDF shape: (200, 400)
2026-02-20 04:14:49.638 | INFO     | __main__:main:1108 -   Building sentence embeddings...
2026-02-20 04:14:58.096 | DEBUG    | __main__:main:1110 -   Embeddings shape: (200, 384)
2026-02-20 04:14:58.096 | INFO     | __main__:main:1135 -   Building char n-gram features (fallback for LLM)...
2026-02-20 04:15:03.438 | DEBUG    | __main__:build_doc2vec_features:384 - Char n-gram features shape: (200, 100)
2026-02-20 04:15:03.438 | INFO     | __main__:main:1159 -   Working subset size: 200
2026-02-20 04:15:03.438 | INFO     | __main__:main:1164 -   Computing CRND scores...
2026-02-20 04:15:03.634 | INFO     | __main__:main:1167 -   Computing label entropy (kDN per space)...
2026-02-20 04:15:03.680 | INFO     | __main__:main:1173 -   Computing cleanlab scores...
2026-02-20 04:15:05.347 | INFO     | __main__:main:1178 -   Computing WANN-adapted scores...
2026-02-20 04:15:05.448 | INFO     | __main__:main:1181 -   Computing cartography proxy scores...
2026-02-20 04:15:14.034 | INFO     | __main__:main:1184 -   Computing hybrid scores (H1-H4)...
2026-02-20 04:15:14.035 | INFO     | __main__:main:1190 -   Running noise injection evaluation...
2026-02-20 04:15:14.512 | INFO     | __main__:main:1232 -   Running significance tests...
2026-02-20 04:15:21.525 | INFO     | __main__:main:1250 -   Running quadrant analysis...
2026-02-20 04:15:21.526 | INFO     | __main__:main:1262 -   Computing Schoener's D niche overlap...
2026-02-20 04:18:35.077 | INFO     | __main__:main:1270 -   Per-class CRND analysis...
2026-02-20 04:18:35.079 | INFO     | __main__:main:1276 -   Testing niche overlap → classifier prediction...
2026-02-20 04:18:37.966 | INFO     | __main__:main:1317 -   Building per-instance output...
2026-02-20 04:18:37.971 | INFO     | __main__:main:1384 -   mental_health_conditions completed in 228s (200 examples)
2026-02-20 04:18:38.107 | INFO     | __main__:main:1095 - === [5/5] Processing medical_transcriptions (N=200) ===
2026-02-20 04:18:38.108 | INFO     | __main__:main:1100 -   Classes (5): ['cardiovascular_pulmonary', 'internal_medicine', 'neurology_psychiatry', 'radiology_consults_obgyn', 'surgical']
2026-02-20 04:18:38.109 | INFO     | __main__:main:1105 -   Building TF-IDF features...
2026-02-20 04:18:38.243 | DEBUG    | __main__:build_tfidf_features:203 - TF-IDF shape: (200, 400)
2026-02-20 04:18:38.243 | INFO     | __main__:main:1108 -   Building sentence embeddings...
2026-02-20 04:18:47.192 | DEBUG    | __main__:main:1110 -   Embeddings shape: (200, 384)
2026-02-20 04:18:47.192 | INFO     | __main__:main:1135 -   Building char n-gram features (fallback for LLM)...
2026-02-20 04:18:53.099 | DEBUG    | __main__:build_doc2vec_features:384 - Char n-gram features shape: (200, 100)
2026-02-20 04:18:53.100 | INFO     | __main__:main:1159 -   Working subset size: 200
2026-02-20 04:18:53.100 | INFO     | __main__:main:1164 -   Computing CRND scores...
2026-02-20 04:18:53.230 | INFO     | __main__:main:1167 -   Computing label entropy (kDN per space)...
2026-02-20 04:18:53.331 | INFO     | __main__:main:1173 -   Computing cleanlab scores...
2026-02-20 04:18:54.655 | INFO     | __main__:main:1178 -   Computing WANN-adapted scores...
2026-02-20 04:18:54.748 | INFO     | __main__:main:1181 -   Computing cartography proxy scores...
2026-02-20 04:19:01.453 | INFO     | __main__:main:1184 -   Computing hybrid scores (H1-H4)...
2026-02-20 04:19:01.479 | INFO     | __main__:main:1190 -   Running noise injection evaluation...
2026-02-20 04:19:02.255 | INFO     | __main__:main:1232 -   Running significance tests...
2026-02-20 04:19:09.866 | INFO     | __main__:main:1250 -   Running quadrant analysis...
2026-02-20 04:19:09.867 | INFO     | __main__:main:1262 -   Computing Schoener's D niche overlap...
2026-02-20 04:20:35.815 | INFO     | __main__:main:1270 -   Per-class CRND analysis...
2026-02-20 04:20:35.817 | INFO     | __main__:main:1276 -   Testing niche overlap → classifier prediction...
2026-02-20 04:20:41.733 | INFO     | __main__:main:1317 -   Building per-instance output...
2026-02-20 04:20:41.743 | INFO     | __main__:main:1384 -   medical_transcriptions completed in 124s (200 examples)
2026-02-20 04:20:42.000 | SUCCESS  | __main__:main:1423 - Saved method_out.json (1000 examples across 5 datasets) in 1865s
2026-02-20 04:20:42.000 | INFO     | __main__:main:1427 - LLM calls: 0, cost: $0.000
2026-02-20 04:22:02.844 | INFO     | __main__:load_and_prepare_datasets:143 - Skipping clinical_patient_triage_nl (N=31, too small for k-NN)
2026-02-20 04:22:03.162 | WARNING  | __main__:load_and_prepare_datasets:146 - Duplicate dataset 'medical_abstracts' — keeping first occurrence
2026-02-20 04:22:03.173 | INFO     | __main__:load_and_prepare_datasets:167 - medical_abstracts: trimmed to 200/14438
2026-02-20 04:22:03.174 | INFO     | __main__:load_and_prepare_datasets:167 - mimic_iv_ed_demo: trimmed to 200/207
2026-02-20 04:22:03.182 | INFO     | __main__:load_and_prepare_datasets:167 - ohsumed_single: trimmed to 200/7400
2026-02-20 04:22:03.193 | INFO     | __main__:load_and_prepare_datasets:167 - mental_health_conditions: trimmed to 200/15000
2026-02-20 04:22:03.198 | INFO     | __main__:load_and_prepare_datasets:167 - medical_transcriptions: trimmed to 200/4966
2026-02-20 04:22:03.212 | INFO     | __main__:load_and_prepare_datasets:183 - medical_abstracts: using all 200
2026-02-20 04:22:03.212 | INFO     | __main__:load_and_prepare_datasets:183 - mimic_iv_ed_demo: using all 200
2026-02-20 04:22:03.212 | INFO     | __main__:load_and_prepare_datasets:183 - ohsumed_single: using all 200
2026-02-20 04:22:03.212 | INFO     | __main__:load_and_prepare_datasets:183 - mental_health_conditions: using all 200
2026-02-20 04:22:03.212 | INFO     | __main__:load_and_prepare_datasets:183 - medical_transcriptions: using all 200
2026-02-20 04:22:03.216 | INFO     | __main__:main:1090 - Loaded 5 datasets: ['medical_abstracts', 'mimic_iv_ed_demo', 'ohsumed_single', 'mental_health_conditions', 'medical_transcriptions']
2026-02-20 04:22:10.409 | INFO     | __main__:main:1102 - === [1/5] Processing medical_abstracts (N=200) ===
2026-02-20 04:22:10.409 | INFO     | __main__:main:1107 -   Classes (5): ['Cardiovascular_diseases', 'Digestive_system_diseases', 'General_pathological_conditions', 'Neoplasms', 'Nervous_system_diseases']
2026-02-20 04:22:10.409 | INFO     | __main__:main:1112 -   Building TF-IDF features...
2026-02-20 04:22:10.466 | DEBUG    | __main__:build_tfidf_features:203 - TF-IDF shape: (200, 400)
2026-02-20 04:22:10.466 | INFO     | __main__:main:1115 -   Building sentence embeddings...
2026-02-20 04:22:19.908 | DEBUG    | __main__:main:1117 -   Embeddings shape: (200, 384)
2026-02-20 04:22:19.908 | INFO     | __main__:main:1142 -   Building char n-gram features (fallback for LLM)...
2026-02-20 04:22:24.760 | DEBUG    | __main__:build_doc2vec_features:384 - Char n-gram features shape: (200, 100)
2026-02-20 04:22:24.760 | INFO     | __main__:main:1166 -   Working subset size: 200
2026-02-20 04:22:24.760 | INFO     | __main__:main:1171 -   Computing CRND scores...
2026-02-20 04:22:24.914 | INFO     | __main__:main:1174 -   Computing label entropy (kDN per space)...
2026-02-20 04:22:25.014 | INFO     | __main__:main:1180 -   Computing cleanlab scores...
2026-02-20 04:22:26.485 | INFO     | __main__:main:1185 -   Computing WANN-adapted scores...
2026-02-20 04:22:26.549 | INFO     | __main__:main:1188 -   Computing cartography proxy scores...
2026-02-20 04:22:29.875 | INFO     | __main__:main:1191 -   Computing hybrid scores (H1-H4)...
2026-02-20 04:22:29.875 | INFO     | __main__:main:1197 -   Running noise injection evaluation...
2026-02-20 04:22:30.126 | INFO     | __main__:main:1239 -   Running significance tests...
2026-02-20 04:22:36.994 | INFO     | __main__:main:1257 -   Running quadrant analysis...
2026-02-20 04:22:36.995 | INFO     | __main__:main:1269 -   Computing Schoener's D niche overlap...
2026-02-20 04:22:46.922 | INFO     | __main__:main:1277 -   Per-class CRND analysis...
2026-02-20 04:22:46.923 | INFO     | __main__:main:1283 -   Testing niche overlap → classifier prediction...
2026-02-20 04:22:48.491 | INFO     | __main__:main:1324 -   Building per-instance output...
2026-02-20 04:22:48.495 | INFO     | __main__:main:1391 -   medical_abstracts completed in 38s (200 examples)
2026-02-20 04:22:48.635 | INFO     | __main__:main:1102 - === [2/5] Processing mimic_iv_ed_demo (N=200) ===
2026-02-20 04:22:48.635 | INFO     | __main__:main:1107 -   Classes (4): ['ESI-1', 'ESI-2', 'ESI-3', 'ESI-4']
2026-02-20 04:22:48.635 | INFO     | __main__:main:1112 -   Building TF-IDF features...
2026-02-20 04:22:48.642 | DEBUG    | __main__:build_tfidf_features:203 - TF-IDF shape: (200, 400)
2026-02-20 04:22:48.642 | INFO     | __main__:main:1115 -   Building sentence embeddings...
2026-02-20 04:22:50.957 | DEBUG    | __main__:main:1117 -   Embeddings shape: (200, 384)
2026-02-20 04:22:50.957 | INFO     | __main__:main:1142 -   Building char n-gram features (fallback for LLM)...
2026-02-20 04:22:54.168 | DEBUG    | __main__:build_doc2vec_features:384 - Char n-gram features shape: (200, 100)
2026-02-20 04:22:54.168 | INFO     | __main__:main:1166 -   Working subset size: 200
2026-02-20 04:22:54.168 | INFO     | __main__:main:1171 -   Computing CRND scores...
2026-02-20 04:22:54.186 | INFO     | __main__:main:1174 -   Computing label entropy (kDN per space)...
2026-02-20 04:22:54.404 | INFO     | __main__:main:1180 -   Computing cleanlab scores...
2026-02-20 04:22:55.405 | INFO     | __main__:main:1185 -   Computing WANN-adapted scores...
2026-02-20 04:22:55.480 | INFO     | __main__:main:1188 -   Computing cartography proxy scores...
2026-02-20 04:22:56.348 | INFO     | __main__:main:1191 -   Computing hybrid scores (H1-H4)...
2026-02-20 04:22:56.349 | INFO     | __main__:main:1197 -   Running noise injection evaluation...
2026-02-20 04:22:56.594 | INFO     | __main__:main:1239 -   Running significance tests...
2026-02-20 04:23:03.807 | INFO     | __main__:main:1257 -   Running quadrant analysis...
2026-02-20 04:23:03.808 | INFO     | __main__:main:1269 -   Computing Schoener's D niche overlap...
2026-02-20 04:23:15.590 | INFO     | __main__:main:1277 -   Per-class CRND analysis...
2026-02-20 04:23:15.593 | INFO     | __main__:main:1283 -   Testing niche overlap → classifier prediction...
2026-02-20 04:23:17.077 | INFO     | __main__:main:1324 -   Building per-instance output...
2026-02-20 04:23:17.079 | INFO     | __main__:main:1391 -   mimic_iv_ed_demo completed in 28s (200 examples)
2026-02-20 04:23:17.239 | INFO     | __main__:main:1102 - === [3/5] Processing ohsumed_single (N=200) ===
2026-02-20 04:23:17.240 | INFO     | __main__:main:1107 -   Classes (23): ['Animal_Diseases', 'Bacterial_Infections_and_Mycoses', 'Cardiovascular_Diseases', 'Digestive_System_Diseases', 'Disorders_of_Environmental_Origin', 'Endocrine_Diseases', 'Eye_Diseases', 'Female_Genital_Diseases_and_Pregnancy_Complications', 'Hemic_and_Lymphatic_Diseases', 'Immunologic_Diseases']
2026-02-20 04:23:17.240 | INFO     | __main__:main:1112 -   Building TF-IDF features...
2026-02-20 04:23:17.304 | DEBUG    | __main__:build_tfidf_features:203 - TF-IDF shape: (200, 400)
2026-02-20 04:23:17.304 | INFO     | __main__:main:1115 -   Building sentence embeddings...
2026-02-20 04:23:29.634 | DEBUG    | __main__:main:1117 -   Embeddings shape: (200, 384)
2026-02-20 04:23:29.634 | INFO     | __main__:main:1142 -   Building char n-gram features (fallback for LLM)...
2026-02-20 04:23:33.769 | DEBUG    | __main__:build_doc2vec_features:384 - Char n-gram features shape: (200, 100)
2026-02-20 04:23:33.770 | INFO     | __main__:main:1166 -   Working subset size: 200
2026-02-20 04:23:33.771 | INFO     | __main__:main:1171 -   Computing CRND scores...
2026-02-20 04:23:33.894 | INFO     | __main__:main:1174 -   Computing label entropy (kDN per space)...
2026-02-20 04:23:34.058 | INFO     | __main__:main:1180 -   Computing cleanlab scores...
2026-02-20 04:23:35.437 | INFO     | __main__:main:1185 -   Computing WANN-adapted scores...
2026-02-20 04:23:35.509 | INFO     | __main__:main:1188 -   Computing cartography proxy scores...
2026-02-20 04:23:38.790 | INFO     | __main__:main:1191 -   Computing hybrid scores (H1-H4)...
2026-02-20 04:23:38.790 | INFO     | __main__:main:1197 -   Running noise injection evaluation...
2026-02-20 04:23:39.106 | INFO     | __main__:main:1239 -   Running significance tests...
2026-02-20 04:23:45.970 | INFO     | __main__:main:1257 -   Running quadrant analysis...
2026-02-20 04:23:45.971 | INFO     | __main__:main:1269 -   Computing Schoener's D niche overlap...
2026-02-20 04:23:49.717 | INFO     | __main__:compute_niche_overlap_matrix:884 -   Niche overlap: sampling 100/253 pairs
2026-02-20 04:23:55.442 | INFO     | __main__:compute_niche_overlap_matrix:884 -   Niche overlap: sampling 100/253 pairs
2026-02-20 04:23:59.032 | INFO     | __main__:compute_niche_overlap_matrix:884 -   Niche overlap: sampling 100/253 pairs
2026-02-20 04:24:01.764 | INFO     | __main__:main:1277 -   Per-class CRND analysis...
2026-02-20 04:24:01.767 | INFO     | __main__:main:1283 -   Testing niche overlap → classifier prediction...
2026-02-20 04:24:03.656 | INFO     | __main__:main:1324 -   Building per-instance output...
2026-02-20 04:24:03.658 | INFO     | __main__:main:1391 -   ohsumed_single completed in 46s (200 examples)
2026-02-20 04:24:03.786 | INFO     | __main__:main:1102 - === [4/5] Processing mental_health_conditions (N=200) ===
2026-02-20 04:24:03.786 | INFO     | __main__:main:1107 -   Classes (7): ['anxiety', 'bipolar', 'depression', 'normal', 'personality disorder', 'stress', 'suicidal']
2026-02-20 04:24:03.786 | INFO     | __main__:main:1112 -   Building TF-IDF features...
2026-02-20 04:24:03.810 | DEBUG    | __main__:build_tfidf_features:203 - TF-IDF shape: (200, 400)
2026-02-20 04:24:03.810 | INFO     | __main__:main:1115 -   Building sentence embeddings...
2026-02-20 04:24:09.040 | DEBUG    | __main__:main:1117 -   Embeddings shape: (200, 384)
2026-02-20 04:24:09.041 | INFO     | __main__:main:1142 -   Building char n-gram features (fallback for LLM)...
2026-02-20 04:24:11.837 | DEBUG    | __main__:build_doc2vec_features:384 - Char n-gram features shape: (200, 100)
2026-02-20 04:24:11.837 | INFO     | __main__:main:1166 -   Working subset size: 200
2026-02-20 04:24:11.837 | INFO     | __main__:main:1171 -   Computing CRND scores...
2026-02-20 04:24:11.967 | INFO     | __main__:main:1174 -   Computing label entropy (kDN per space)...
2026-02-20 04:24:12.098 | INFO     | __main__:main:1180 -   Computing cleanlab scores...
2026-02-20 04:24:13.218 | INFO     | __main__:main:1185 -   Computing WANN-adapted scores...
2026-02-20 04:24:13.307 | INFO     | __main__:main:1188 -   Computing cartography proxy scores...
2026-02-20 04:24:16.324 | INFO     | __main__:main:1191 -   Computing hybrid scores (H1-H4)...
2026-02-20 04:24:16.325 | INFO     | __main__:main:1197 -   Running noise injection evaluation...
2026-02-20 04:24:16.586 | INFO     | __main__:main:1239 -   Running significance tests...
2026-02-20 04:24:23.421 | INFO     | __main__:main:1257 -   Running quadrant analysis...
2026-02-20 04:24:23.422 | INFO     | __main__:main:1269 -   Computing Schoener's D niche overlap...
2026-02-20 04:24:40.422 | INFO     | __main__:main:1277 -   Per-class CRND analysis...
2026-02-20 04:24:40.424 | INFO     | __main__:main:1283 -   Testing niche overlap → classifier prediction...
2026-02-20 04:24:42.021 | INFO     | __main__:main:1324 -   Building per-instance output...
2026-02-20 04:24:42.024 | INFO     | __main__:main:1391 -   mental_health_conditions completed in 38s (200 examples)
2026-02-20 04:24:42.159 | INFO     | __main__:main:1102 - === [5/5] Processing medical_transcriptions (N=200) ===
2026-02-20 04:24:42.159 | INFO     | __main__:main:1107 -   Classes (5): ['cardiovascular_pulmonary', 'internal_medicine', 'neurology_psychiatry', 'radiology_consults_obgyn', 'surgical']
2026-02-20 04:24:42.159 | INFO     | __main__:main:1112 -   Building TF-IDF features...
2026-02-20 04:24:42.283 | DEBUG    | __main__:build_tfidf_features:203 - TF-IDF shape: (200, 400)
2026-02-20 04:24:42.283 | INFO     | __main__:main:1115 -   Building sentence embeddings...
2026-02-20 04:24:54.867 | DEBUG    | __main__:main:1117 -   Embeddings shape: (200, 384)
2026-02-20 04:24:54.867 | INFO     | __main__:main:1142 -   Building char n-gram features (fallback for LLM)...
2026-02-20 04:24:58.419 | DEBUG    | __main__:build_doc2vec_features:384 - Char n-gram features shape: (200, 100)
2026-02-20 04:24:58.420 | INFO     | __main__:main:1166 -   Working subset size: 200
2026-02-20 04:24:58.420 | INFO     | __main__:main:1171 -   Computing CRND scores...
2026-02-20 04:24:58.561 | INFO     | __main__:main:1174 -   Computing label entropy (kDN per space)...
2026-02-20 04:24:58.655 | INFO     | __main__:main:1180 -   Computing cleanlab scores...
2026-02-20 04:25:00.541 | INFO     | __main__:main:1185 -   Computing WANN-adapted scores...
2026-02-20 04:25:00.684 | INFO     | __main__:main:1188 -   Computing cartography proxy scores...
2026-02-20 04:25:04.389 | INFO     | __main__:main:1191 -   Computing hybrid scores (H1-H4)...
2026-02-20 04:25:04.390 | INFO     | __main__:main:1197 -   Running noise injection evaluation...
2026-02-20 04:25:04.673 | INFO     | __main__:main:1239 -   Running significance tests...
2026-02-20 04:25:11.526 | INFO     | __main__:main:1257 -   Running quadrant analysis...
2026-02-20 04:25:11.527 | INFO     | __main__:main:1269 -   Computing Schoener's D niche overlap...
2026-02-20 04:25:20.246 | INFO     | __main__:main:1277 -   Per-class CRND analysis...
2026-02-20 04:25:20.247 | INFO     | __main__:main:1283 -   Testing niche overlap → classifier prediction...
2026-02-20 04:25:22.901 | INFO     | __main__:main:1324 -   Building per-instance output...
2026-02-20 04:25:22.903 | INFO     | __main__:main:1391 -   medical_transcriptions completed in 41s (200 examples)
2026-02-20 04:25:23.142 | SUCCESS  | __main__:main:1430 - Saved method_out.json (1000 examples across 5 datasets) in 201s
2026-02-20 04:25:23.143 | INFO     | __main__:main:1434 - LLM calls: 0, cost: $0.000
2026-02-20 04:25:31.903 | INFO     | __main__:load_and_prepare_datasets:143 - Skipping clinical_patient_triage_nl (N=31, too small for k-NN)
2026-02-20 04:25:32.153 | WARNING  | __main__:load_and_prepare_datasets:146 - Duplicate dataset 'medical_abstracts' — keeping first occurrence
2026-02-20 04:25:32.163 | INFO     | __main__:load_and_prepare_datasets:180 - medical_abstracts: sampled 500/14438
2026-02-20 04:25:32.163 | INFO     | __main__:load_and_prepare_datasets:183 - mimic_iv_ed_demo: using all 207
2026-02-20 04:25:32.169 | INFO     | __main__:load_and_prepare_datasets:180 - ohsumed_single: sampled 500/7400
2026-02-20 04:25:32.175 | INFO     | __main__:load_and_prepare_datasets:180 - mental_health_conditions: sampled 500/15000
2026-02-20 04:25:32.177 | INFO     | __main__:load_and_prepare_datasets:180 - medical_transcriptions: sampled 500/4966
2026-02-20 04:25:32.190 | INFO     | __main__:main:1090 - Loaded 5 datasets: ['medical_abstracts', 'mimic_iv_ed_demo', 'ohsumed_single', 'mental_health_conditions', 'medical_transcriptions']
2026-02-20 04:25:38.720 | INFO     | __main__:main:1102 - === [1/5] Processing medical_abstracts (N=500) ===
2026-02-20 04:25:38.721 | INFO     | __main__:main:1107 -   Classes (5): ['Cardiovascular_diseases', 'Digestive_system_diseases', 'General_pathological_conditions', 'Neoplasms', 'Nervous_system_diseases']
2026-02-20 04:25:38.721 | INFO     | __main__:main:1112 -   Building TF-IDF features...
2026-02-20 04:25:38.866 | DEBUG    | __main__:build_tfidf_features:203 - TF-IDF shape: (500, 1000)
2026-02-20 04:25:38.867 | INFO     | __main__:main:1115 -   Building sentence embeddings...
2026-02-20 04:26:02.473 | DEBUG    | __main__:main:1117 -   Embeddings shape: (500, 384)
2026-02-20 04:26:02.473 | INFO     | __main__:main:1142 -   Building char n-gram features (fallback for LLM)...
2026-02-20 04:26:12.742 | DEBUG    | __main__:build_doc2vec_features:384 - Char n-gram features shape: (500, 100)
2026-02-20 04:26:12.742 | INFO     | __main__:main:1166 -   Working subset size: 500
2026-02-20 04:26:12.743 | INFO     | __main__:main:1171 -   Computing CRND scores...
2026-02-20 04:26:12.967 | INFO     | __main__:main:1174 -   Computing label entropy (kDN per space)...
2026-02-20 04:26:13.169 | INFO     | __main__:main:1180 -   Computing cleanlab scores...
2026-02-20 04:26:34.057 | INFO     | __main__:main:1185 -   Computing WANN-adapted scores...
2026-02-20 04:26:34.248 | INFO     | __main__:main:1188 -   Computing cartography proxy scores...
2026-02-20 04:28:13.758 | INFO     | __main__:main:1191 -   Computing hybrid scores (H1-H4)...
2026-02-20 04:28:13.759 | INFO     | __main__:main:1197 -   Running noise injection evaluation...
2026-02-20 04:28:14.071 | INFO     | __main__:main:1239 -   Running significance tests...
2026-02-20 04:28:21.483 | INFO     | __main__:main:1257 -   Running quadrant analysis...
2026-02-20 04:28:21.484 | INFO     | __main__:main:1269 -   Computing Schoener's D niche overlap...
2026-02-20 04:28:32.895 | INFO     | __main__:main:1277 -   Per-class CRND analysis...
2026-02-20 04:28:32.897 | INFO     | __main__:main:1283 -   Testing niche overlap → classifier prediction...
2026-02-20 04:28:58.239 | INFO     | __main__:main:1324 -   Building per-instance output...
2026-02-20 04:28:58.247 | INFO     | __main__:main:1391 -   medical_abstracts completed in 200s (500 examples)
2026-02-20 04:28:58.378 | INFO     | __main__:main:1102 - === [2/5] Processing mimic_iv_ed_demo (N=207) ===
2026-02-20 04:28:58.379 | INFO     | __main__:main:1107 -   Classes (4): ['ESI-1', 'ESI-2', 'ESI-3', 'ESI-4']
2026-02-20 04:28:58.379 | INFO     | __main__:main:1112 -   Building TF-IDF features...
2026-02-20 04:28:58.386 | DEBUG    | __main__:build_tfidf_features:203 - TF-IDF shape: (207, 414)
2026-02-20 04:28:58.386 | INFO     | __main__:main:1115 -   Building sentence embeddings...
2026-02-20 04:29:00.834 | DEBUG    | __main__:main:1117 -   Embeddings shape: (207, 384)
2026-02-20 04:29:00.834 | INFO     | __main__:main:1142 -   Building char n-gram features (fallback for LLM)...
2026-02-20 04:29:04.921 | DEBUG    | __main__:build_doc2vec_features:384 - Char n-gram features shape: (207, 100)
2026-02-20 04:29:04.921 | INFO     | __main__:main:1166 -   Working subset size: 207
2026-02-20 04:29:04.922 | INFO     | __main__:main:1171 -   Computing CRND scores...
2026-02-20 04:29:05.105 | INFO     | __main__:main:1174 -   Computing label entropy (kDN per space)...
2026-02-20 04:29:05.229 | INFO     | __main__:main:1180 -   Computing cleanlab scores...
2026-02-20 04:29:05.940 | INFO     | __main__:main:1185 -   Computing WANN-adapted scores...
2026-02-20 04:29:06.033 | INFO     | __main__:main:1188 -   Computing cartography proxy scores...
2026-02-20 04:29:06.966 | INFO     | __main__:main:1191 -   Computing hybrid scores (H1-H4)...
2026-02-20 04:29:06.967 | INFO     | __main__:main:1197 -   Running noise injection evaluation...
2026-02-20 04:29:07.225 | INFO     | __main__:main:1239 -   Running significance tests...
2026-02-20 04:29:13.804 | INFO     | __main__:main:1257 -   Running quadrant analysis...
2026-02-20 04:29:13.804 | INFO     | __main__:main:1269 -   Computing Schoener's D niche overlap...
2026-02-20 04:29:26.278 | INFO     | __main__:main:1277 -   Per-class CRND analysis...
2026-02-20 04:29:26.280 | INFO     | __main__:main:1283 -   Testing niche overlap → classifier prediction...
2026-02-20 04:29:26.920 | INFO     | __main__:main:1324 -   Building per-instance output...
2026-02-20 04:29:26.922 | INFO     | __main__:main:1391 -   mimic_iv_ed_demo completed in 29s (207 examples)
2026-02-20 04:29:27.055 | INFO     | __main__:main:1102 - === [3/5] Processing ohsumed_single (N=500) ===
2026-02-20 04:29:27.056 | INFO     | __main__:main:1107 -   Classes (23): ['Animal_Diseases', 'Bacterial_Infections_and_Mycoses', 'Cardiovascular_Diseases', 'Digestive_System_Diseases', 'Disorders_of_Environmental_Origin', 'Endocrine_Diseases', 'Eye_Diseases', 'Female_Genital_Diseases_and_Pregnancy_Complications', 'Hemic_and_Lymphatic_Diseases', 'Immunologic_Diseases']
2026-02-20 04:29:27.056 | INFO     | __main__:main:1112 -   Building TF-IDF features...
2026-02-20 04:29:27.206 | DEBUG    | __main__:build_tfidf_features:203 - TF-IDF shape: (500, 1000)
2026-02-20 04:29:27.206 | INFO     | __main__:main:1115 -   Building sentence embeddings...
2026-02-20 04:29:48.707 | DEBUG    | __main__:main:1117 -   Embeddings shape: (500, 384)
2026-02-20 04:29:48.708 | INFO     | __main__:main:1142 -   Building char n-gram features (fallback for LLM)...
2026-02-20 04:29:56.958 | DEBUG    | __main__:build_doc2vec_features:384 - Char n-gram features shape: (500, 100)
2026-02-20 04:29:56.959 | INFO     | __main__:main:1166 -   Working subset size: 500
2026-02-20 04:29:56.959 | INFO     | __main__:main:1171 -   Computing CRND scores...
2026-02-20 04:29:57.186 | INFO     | __main__:main:1174 -   Computing label entropy (kDN per space)...
2026-02-20 04:29:57.433 | INFO     | __main__:main:1180 -   Computing cleanlab scores...
2026-02-20 04:30:19.464 | INFO     | __main__:main:1185 -   Computing WANN-adapted scores...
2026-02-20 04:30:19.511 | INFO     | __main__:main:1188 -   Computing cartography proxy scores...
2026-02-20 04:31:35.887 | INFO     | __main__:main:1191 -   Computing hybrid scores (H1-H4)...
2026-02-20 04:31:35.888 | INFO     | __main__:main:1197 -   Running noise injection evaluation...
2026-02-20 04:31:36.181 | INFO     | __main__:main:1239 -   Running significance tests...
2026-02-20 04:31:43.261 | INFO     | __main__:main:1257 -   Running quadrant analysis...
2026-02-20 04:31:43.262 | INFO     | __main__:main:1269 -   Computing Schoener's D niche overlap...
2026-02-20 04:31:43.807 | INFO     | __main__:compute_niche_overlap_matrix:884 -   Niche overlap: sampling 100/253 pairs
2026-02-20 04:31:52.520 | INFO     | __main__:compute_niche_overlap_matrix:884 -   Niche overlap: sampling 100/253 pairs
2026-02-20 04:31:56.988 | INFO     | __main__:compute_niche_overlap_matrix:884 -   Niche overlap: sampling 100/253 pairs
2026-02-20 04:32:02.453 | INFO     | __main__:main:1277 -   Per-class CRND analysis...
2026-02-20 04:32:02.481 | INFO     | __main__:main:1283 -   Testing niche overlap → classifier prediction...
2026-02-20 04:32:23.504 | INFO     | __main__:main:1324 -   Building per-instance output...
2026-02-20 04:32:23.526 | INFO     | __main__:main:1391 -   ohsumed_single completed in 176s (500 examples)
2026-02-20 04:32:23.661 | INFO     | __main__:main:1102 - === [4/5] Processing mental_health_conditions (N=500) ===
2026-02-20 04:32:23.662 | INFO     | __main__:main:1107 -   Classes (7): ['anxiety', 'bipolar', 'depression', 'normal', 'personality disorder', 'stress', 'suicidal']
2026-02-20 04:32:23.662 | INFO     | __main__:main:1112 -   Building TF-IDF features...
2026-02-20 04:32:23.713 | DEBUG    | __main__:build_tfidf_features:203 - TF-IDF shape: (500, 1000)
2026-02-20 04:32:23.713 | INFO     | __main__:main:1115 -   Building sentence embeddings...
2026-02-20 04:32:34.535 | DEBUG    | __main__:main:1117 -   Embeddings shape: (500, 384)
2026-02-20 04:32:34.536 | INFO     | __main__:main:1142 -   Building char n-gram features (fallback for LLM)...
2026-02-20 04:32:42.308 | DEBUG    | __main__:build_doc2vec_features:384 - Char n-gram features shape: (500, 100)
2026-02-20 04:32:42.308 | INFO     | __main__:main:1166 -   Working subset size: 500
2026-02-20 04:32:42.308 | INFO     | __main__:main:1171 -   Computing CRND scores...
2026-02-20 04:32:42.509 | INFO     | __main__:main:1174 -   Computing label entropy (kDN per space)...
2026-02-20 04:32:42.682 | INFO     | __main__:main:1180 -   Computing cleanlab scores...
2026-02-20 04:33:03.380 | INFO     | __main__:main:1185 -   Computing WANN-adapted scores...
2026-02-20 04:33:03.480 | INFO     | __main__:main:1188 -   Computing cartography proxy scores...
2026-02-20 04:34:00.539 | INFO     | __main__:main:1191 -   Computing hybrid scores (H1-H4)...
2026-02-20 04:34:00.540 | INFO     | __main__:main:1197 -   Running noise injection evaluation...
2026-02-20 04:34:00.856 | INFO     | __main__:main:1239 -   Running significance tests...
2026-02-20 04:34:07.871 | INFO     | __main__:main:1257 -   Running quadrant analysis...
2026-02-20 04:34:07.872 | INFO     | __main__:main:1269 -   Computing Schoener's D niche overlap...
2026-02-20 04:34:22.688 | INFO     | __main__:main:1277 -   Per-class CRND analysis...
2026-02-20 04:34:22.689 | INFO     | __main__:main:1283 -   Testing niche overlap → classifier prediction...
2026-02-20 04:34:39.717 | INFO     | __main__:main:1324 -   Building per-instance output...
2026-02-20 04:34:39.731 | INFO     | __main__:main:1391 -   mental_health_conditions completed in 136s (500 examples)
2026-02-20 04:34:39.884 | INFO     | __main__:main:1102 - === [5/5] Processing medical_transcriptions (N=500) ===
2026-02-20 04:34:39.884 | INFO     | __main__:main:1107 -   Classes (5): ['cardiovascular_pulmonary', 'internal_medicine', 'neurology_psychiatry', 'radiology_consults_obgyn', 'surgical']
2026-02-20 04:34:39.884 | INFO     | __main__:main:1112 -   Building TF-IDF features...
2026-02-20 04:34:40.231 | DEBUG    | __main__:build_tfidf_features:203 - TF-IDF shape: (500, 1000)
2026-02-20 04:34:40.232 | INFO     | __main__:main:1115 -   Building sentence embeddings...
2026-02-20 04:35:05.971 | DEBUG    | __main__:main:1117 -   Embeddings shape: (500, 384)
2026-02-20 04:35:05.971 | INFO     | __main__:main:1142 -   Building char n-gram features (fallback for LLM)...
2026-02-20 04:35:16.576 | DEBUG    | __main__:build_doc2vec_features:384 - Char n-gram features shape: (500, 100)
2026-02-20 04:35:16.580 | INFO     | __main__:main:1166 -   Working subset size: 500
2026-02-20 04:35:16.581 | INFO     | __main__:main:1171 -   Computing CRND scores...
2026-02-20 04:35:16.833 | INFO     | __main__:main:1174 -   Computing label entropy (kDN per space)...
2026-02-20 04:35:16.956 | INFO     | __main__:main:1180 -   Computing cleanlab scores...
2026-02-20 04:35:39.741 | INFO     | __main__:main:1185 -   Computing WANN-adapted scores...
2026-02-20 04:35:39.818 | INFO     | __main__:main:1188 -   Computing cartography proxy scores...
2026-02-20 04:37:00.823 | INFO     | __main__:main:1191 -   Computing hybrid scores (H1-H4)...
2026-02-20 04:37:00.823 | INFO     | __main__:main:1197 -   Running noise injection evaluation...
2026-02-20 04:37:01.144 | INFO     | __main__:main:1239 -   Running significance tests...
2026-02-20 04:37:08.478 | INFO     | __main__:main:1257 -   Running quadrant analysis...
2026-02-20 04:37:08.480 | INFO     | __main__:main:1269 -   Computing Schoener's D niche overlap...
2026-02-20 04:37:16.216 | INFO     | __main__:main:1277 -   Per-class CRND analysis...
2026-02-20 04:37:16.218 | INFO     | __main__:main:1283 -   Testing niche overlap → classifier prediction...
2026-02-20 04:37:38.384 | INFO     | __main__:main:1324 -   Building per-instance output...
2026-02-20 04:37:38.396 | INFO     | __main__:main:1391 -   medical_transcriptions completed in 179s (500 examples)
2026-02-20 04:37:38.749 | SUCCESS  | __main__:main:1430 - Saved method_out.json (2207 examples across 5 datasets) in 728s
2026-02-20 04:37:38.749 | INFO     | __main__:main:1434 - LLM calls: 0, cost: $0.000
2026-02-20 04:38:52.315 | INFO     | __main__:load_and_prepare_datasets:143 - Skipping clinical_patient_triage_nl (N=31, too small for k-NN)
2026-02-20 04:38:52.564 | WARNING  | __main__:load_and_prepare_datasets:146 - Duplicate dataset 'medical_abstracts' — keeping first occurrence
2026-02-20 04:38:52.574 | INFO     | __main__:load_and_prepare_datasets:180 - medical_abstracts: sampled 500/14438
2026-02-20 04:38:52.574 | INFO     | __main__:load_and_prepare_datasets:183 - mimic_iv_ed_demo: using all 207
2026-02-20 04:38:52.581 | INFO     | __main__:load_and_prepare_datasets:180 - ohsumed_single: sampled 500/7400
2026-02-20 04:38:52.586 | INFO     | __main__:load_and_prepare_datasets:180 - mental_health_conditions: sampled 500/15000
2026-02-20 04:38:52.588 | INFO     | __main__:load_and_prepare_datasets:180 - medical_transcriptions: sampled 500/4966
2026-02-20 04:38:52.601 | INFO     | __main__:main:1090 - Loaded 5 datasets: ['medical_abstracts', 'mimic_iv_ed_demo', 'ohsumed_single', 'mental_health_conditions', 'medical_transcriptions']
2026-02-20 04:38:59.438 | INFO     | __main__:main:1102 - === [1/5] Processing medical_abstracts (N=500) ===
2026-02-20 04:38:59.439 | INFO     | __main__:main:1107 -   Classes (5): ['Cardiovascular_diseases', 'Digestive_system_diseases', 'General_pathological_conditions', 'Neoplasms', 'Nervous_system_diseases']
2026-02-20 04:38:59.439 | INFO     | __main__:main:1112 -   Building TF-IDF features...
2026-02-20 04:38:59.645 | DEBUG    | __main__:build_tfidf_features:203 - TF-IDF shape: (500, 1000)
2026-02-20 04:38:59.646 | INFO     | __main__:main:1115 -   Building sentence embeddings...
2026-02-20 04:39:21.327 | DEBUG    | __main__:main:1117 -   Embeddings shape: (500, 384)
2026-02-20 04:39:21.328 | INFO     | __main__:main:1124 -   Building LLM features (subset=100)...
2026-02-20 04:41:09.271 | INFO     | __main__:main:1166 -   Working subset size: 100
2026-02-20 04:41:09.272 | INFO     | __main__:main:1171 -   Computing CRND scores...
2026-02-20 04:41:09.278 | INFO     | __main__:main:1174 -   Computing label entropy (kDN per space)...
2026-02-20 04:41:09.284 | INFO     | __main__:main:1180 -   Computing cleanlab scores...
2026-02-20 04:41:10.316 | INFO     | __main__:main:1185 -   Computing WANN-adapted scores...
2026-02-20 04:41:10.375 | INFO     | __main__:main:1188 -   Computing cartography proxy scores...
2026-02-20 04:41:12.718 | INFO     | __main__:main:1191 -   Computing hybrid scores (H1-H4)...
2026-02-20 04:41:12.718 | INFO     | __main__:main:1197 -   Running noise injection evaluation...
2026-02-20 04:41:12.983 | INFO     | __main__:main:1239 -   Running significance tests...
2026-02-20 04:41:19.267 | INFO     | __main__:main:1257 -   Running quadrant analysis...
2026-02-20 04:41:19.268 | INFO     | __main__:main:1269 -   Computing Schoener's D niche overlap...
2026-02-20 04:41:23.804 | INFO     | __main__:main:1277 -   Per-class CRND analysis...
2026-02-20 04:41:23.806 | INFO     | __main__:main:1283 -   Testing niche overlap → classifier prediction...
2026-02-20 04:41:25.528 | INFO     | __main__:main:1324 -   Building per-instance output...
2026-02-20 04:41:25.529 | INFO     | __main__:main:1391 -   medical_abstracts completed in 146s (100 examples)
2026-02-20 04:41:25.698 | INFO     | __main__:main:1102 - === [2/5] Processing mimic_iv_ed_demo (N=207) ===
2026-02-20 04:41:25.698 | INFO     | __main__:main:1107 -   Classes (4): ['ESI-1', 'ESI-2', 'ESI-3', 'ESI-4']
2026-02-20 04:41:25.698 | INFO     | __main__:main:1112 -   Building TF-IDF features...
2026-02-20 04:41:25.705 | DEBUG    | __main__:build_tfidf_features:203 - TF-IDF shape: (207, 414)
2026-02-20 04:41:25.705 | INFO     | __main__:main:1115 -   Building sentence embeddings...
2026-02-20 04:41:28.016 | DEBUG    | __main__:main:1117 -   Embeddings shape: (207, 384)
2026-02-20 04:41:28.016 | INFO     | __main__:main:1124 -   Building LLM features (subset=100)...
2026-02-20 04:42:54.859 | INFO     | __main__:main:1166 -   Working subset size: 100
2026-02-20 04:42:54.859 | INFO     | __main__:main:1171 -   Computing CRND scores...
2026-02-20 04:42:54.873 | INFO     | __main__:main:1174 -   Computing label entropy (kDN per space)...
2026-02-20 04:42:54.879 | INFO     | __main__:main:1180 -   Computing cleanlab scores...
2026-02-20 04:42:55.793 | INFO     | __main__:main:1185 -   Computing WANN-adapted scores...
2026-02-20 04:42:55.862 | INFO     | __main__:main:1188 -   Computing cartography proxy scores...
2026-02-20 04:42:56.831 | INFO     | __main__:main:1191 -   Computing hybrid scores (H1-H4)...
2026-02-20 04:42:56.831 | INFO     | __main__:main:1197 -   Running noise injection evaluation...
2026-02-20 04:42:57.070 | INFO     | __main__:main:1239 -   Running significance tests...
2026-02-20 04:43:03.428 | INFO     | __main__:main:1257 -   Running quadrant analysis...
2026-02-20 04:43:03.429 | INFO     | __main__:main:1269 -   Computing Schoener's D niche overlap...
2026-02-20 04:43:12.199 | INFO     | __main__:main:1277 -   Per-class CRND analysis...
2026-02-20 04:43:12.207 | INFO     | __main__:main:1283 -   Testing niche overlap → classifier prediction...
2026-02-20 04:43:13.370 | INFO     | __main__:main:1324 -   Building per-instance output...
2026-02-20 04:43:13.371 | INFO     | __main__:main:1391 -   mimic_iv_ed_demo completed in 108s (100 examples)
2026-02-20 04:43:13.498 | INFO     | __main__:main:1102 - === [3/5] Processing ohsumed_single (N=500) ===
2026-02-20 04:43:13.498 | INFO     | __main__:main:1107 -   Classes (23): ['Animal_Diseases', 'Bacterial_Infections_and_Mycoses', 'Cardiovascular_Diseases', 'Digestive_System_Diseases', 'Disorders_of_Environmental_Origin', 'Endocrine_Diseases', 'Eye_Diseases', 'Female_Genital_Diseases_and_Pregnancy_Complications', 'Hemic_and_Lymphatic_Diseases', 'Immunologic_Diseases']
2026-02-20 04:43:13.499 | INFO     | __main__:main:1112 -   Building TF-IDF features...
2026-02-20 04:43:13.646 | DEBUG    | __main__:build_tfidf_features:203 - TF-IDF shape: (500, 1000)
2026-02-20 04:43:13.646 | INFO     | __main__:main:1115 -   Building sentence embeddings...
2026-02-20 04:43:34.794 | DEBUG    | __main__:main:1117 -   Embeddings shape: (500, 384)
2026-02-20 04:43:34.795 | INFO     | __main__:main:1124 -   Building LLM features (subset=100)...
2026-02-20 04:45:14.940 | INFO     | __main__:main:1166 -   Working subset size: 100
2026-02-20 04:45:14.940 | INFO     | __main__:main:1171 -   Computing CRND scores...
2026-02-20 04:45:14.947 | INFO     | __main__:main:1174 -   Computing label entropy (kDN per space)...
2026-02-20 04:45:14.955 | INFO     | __main__:main:1180 -   Computing cleanlab scores...
2026-02-20 04:45:19.305 | INFO     | __main__:main:1185 -   Computing WANN-adapted scores...
2026-02-20 04:45:19.357 | INFO     | __main__:main:1188 -   Computing cartography proxy scores...
2026-02-20 04:45:39.948 | INFO     | __main__:main:1191 -   Computing hybrid scores (H1-H4)...
2026-02-20 04:45:39.949 | INFO     | __main__:main:1197 -   Running noise injection evaluation...
2026-02-20 04:45:40.192 | INFO     | __main__:main:1239 -   Running significance tests...
2026-02-20 04:45:46.474 | INFO     | __main__:main:1257 -   Running quadrant analysis...
2026-02-20 04:45:46.474 | INFO     | __main__:main:1269 -   Computing Schoener's D niche overlap...
2026-02-20 04:45:46.607 | INFO     | __main__:compute_niche_overlap_matrix:884 -   Niche overlap: sampling 100/253 pairs
2026-02-20 04:45:48.456 | INFO     | __main__:compute_niche_overlap_matrix:884 -   Niche overlap: sampling 100/253 pairs
2026-02-20 04:45:51.316 | INFO     | __main__:compute_niche_overlap_matrix:884 -   Niche overlap: sampling 100/253 pairs
2026-02-20 04:45:55.111 | INFO     | __main__:main:1277 -   Per-class CRND analysis...
2026-02-20 04:45:55.116 | INFO     | __main__:main:1283 -   Testing niche overlap → classifier prediction...
2026-02-20 04:46:00.708 | INFO     | __main__:main:1324 -   Building per-instance output...
2026-02-20 04:46:00.710 | INFO     | __main__:main:1391 -   ohsumed_single completed in 167s (100 examples)
2026-02-20 04:46:00.827 | INFO     | __main__:main:1102 - === [4/5] Processing mental_health_conditions (N=500) ===
2026-02-20 04:46:00.828 | INFO     | __main__:main:1107 -   Classes (7): ['anxiety', 'bipolar', 'depression', 'normal', 'personality disorder', 'stress', 'suicidal']
2026-02-20 04:46:00.828 | INFO     | __main__:main:1112 -   Building TF-IDF features...
2026-02-20 04:46:00.886 | DEBUG    | __main__:build_tfidf_features:203 - TF-IDF shape: (500, 1000)
2026-02-20 04:46:00.887 | INFO     | __main__:main:1115 -   Building sentence embeddings...
2026-02-20 04:46:11.513 | DEBUG    | __main__:main:1117 -   Embeddings shape: (500, 384)
2026-02-20 04:46:11.514 | INFO     | __main__:main:1124 -   Building LLM features (subset=100)...
2026-02-20 04:47:46.495 | INFO     | __main__:main:1166 -   Working subset size: 100
2026-02-20 04:47:46.495 | INFO     | __main__:main:1171 -   Computing CRND scores...
2026-02-20 04:47:46.502 | INFO     | __main__:main:1174 -   Computing label entropy (kDN per space)...
2026-02-20 04:47:46.508 | INFO     | __main__:main:1180 -   Computing cleanlab scores...
2026-02-20 04:47:47.524 | INFO     | __main__:main:1185 -   Computing WANN-adapted scores...
2026-02-20 04:47:47.551 | INFO     | __main__:main:1188 -   Computing cartography proxy scores...
2026-02-20 04:47:52.368 | INFO     | __main__:main:1191 -   Computing hybrid scores (H1-H4)...
2026-02-20 04:47:52.368 | INFO     | __main__:main:1197 -   Running noise injection evaluation...
2026-02-20 04:47:52.604 | INFO     | __main__:main:1239 -   Running significance tests...
2026-02-20 04:47:59.934 | INFO     | __main__:main:1257 -   Running quadrant analysis...
2026-02-20 04:47:59.935 | INFO     | __main__:main:1269 -   Computing Schoener's D niche overlap...
2026-02-20 04:48:03.050 | INFO     | __main__:main:1277 -   Per-class CRND analysis...
2026-02-20 04:48:03.052 | INFO     | __main__:main:1283 -   Testing niche overlap → classifier prediction...
2026-02-20 04:48:04.756 | INFO     | __main__:main:1324 -   Building per-instance output...
2026-02-20 04:48:04.757 | INFO     | __main__:main:1391 -   mental_health_conditions completed in 124s (100 examples)
2026-02-20 04:48:04.870 | INFO     | __main__:main:1102 - === [5/5] Processing medical_transcriptions (N=500) ===
2026-02-20 04:48:04.870 | INFO     | __main__:main:1107 -   Classes (5): ['cardiovascular_pulmonary', 'internal_medicine', 'neurology_psychiatry', 'radiology_consults_obgyn', 'surgical']
2026-02-20 04:48:04.870 | INFO     | __main__:main:1112 -   Building TF-IDF features...
2026-02-20 04:48:05.241 | DEBUG    | __main__:build_tfidf_features:203 - TF-IDF shape: (500, 1000)
2026-02-20 04:48:05.241 | INFO     | __main__:main:1115 -   Building sentence embeddings...
2026-02-20 04:48:27.798 | DEBUG    | __main__:main:1117 -   Embeddings shape: (500, 384)
2026-02-20 04:48:27.799 | INFO     | __main__:main:1124 -   Building LLM features (subset=100)...
2026-02-20 04:50:17.661 | INFO     | __main__:main:1166 -   Working subset size: 100
2026-02-20 04:50:17.661 | INFO     | __main__:main:1171 -   Computing CRND scores...
2026-02-20 04:50:17.726 | INFO     | __main__:main:1174 -   Computing label entropy (kDN per space)...
2026-02-20 04:50:17.738 | INFO     | __main__:main:1180 -   Computing cleanlab scores...
2026-02-20 04:50:19.109 | INFO     | __main__:main:1185 -   Computing WANN-adapted scores...
2026-02-20 04:50:19.187 | INFO     | __main__:main:1188 -   Computing cartography proxy scores...
2026-02-20 04:50:22.476 | INFO     | __main__:main:1191 -   Computing hybrid scores (H1-H4)...
2026-02-20 04:50:22.486 | INFO     | __main__:main:1197 -   Running noise injection evaluation...
2026-02-20 04:50:22.756 | INFO     | __main__:main:1239 -   Running significance tests...
2026-02-20 04:50:29.232 | INFO     | __main__:main:1257 -   Running quadrant analysis...
2026-02-20 04:50:29.232 | INFO     | __main__:main:1269 -   Computing Schoener's D niche overlap...
2026-02-20 04:50:32.941 | INFO     | __main__:main:1277 -   Per-class CRND analysis...
2026-02-20 04:50:32.943 | INFO     | __main__:main:1283 -   Testing niche overlap → classifier prediction...
2026-02-20 04:50:34.716 | INFO     | __main__:main:1324 -   Building per-instance output...
2026-02-20 04:50:34.718 | INFO     | __main__:main:1391 -   medical_transcriptions completed in 150s (100 examples)
2026-02-20 04:50:34.885 | SUCCESS  | __main__:main:1430 - Saved method_out.json (500 examples across 5 datasets) in 703s
2026-02-20 04:50:34.885 | INFO     | __main__:main:1434 - LLM calls: 100, cost: $0.100
2026-02-20 04:50:57.773 | INFO     | __main__:load_and_prepare_datasets:143 - Skipping clinical_patient_triage_nl (N=31, too small for k-NN)
2026-02-20 04:50:58.031 | WARNING  | __main__:load_and_prepare_datasets:146 - Duplicate dataset 'medical_abstracts' — keeping first occurrence
2026-02-20 04:50:58.041 | INFO     | __main__:load_and_prepare_datasets:180 - medical_abstracts: sampled 500/14438
2026-02-20 04:50:58.042 | INFO     | __main__:load_and_prepare_datasets:183 - mimic_iv_ed_demo: using all 207
2026-02-20 04:50:58.047 | INFO     | __main__:load_and_prepare_datasets:180 - ohsumed_single: sampled 500/7400
2026-02-20 04:50:58.053 | INFO     | __main__:load_and_prepare_datasets:180 - mental_health_conditions: sampled 500/15000
2026-02-20 04:50:58.055 | INFO     | __main__:load_and_prepare_datasets:180 - medical_transcriptions: sampled 500/4966
2026-02-20 04:50:58.074 | INFO     | __main__:main:1090 - Loaded 5 datasets: ['medical_abstracts', 'mimic_iv_ed_demo', 'ohsumed_single', 'mental_health_conditions', 'medical_transcriptions']
2026-02-20 04:51:04.530 | INFO     | __main__:main:1102 - === [1/5] Processing medical_abstracts (N=500) ===
2026-02-20 04:51:04.531 | INFO     | __main__:main:1107 -   Classes (5): ['Cardiovascular_diseases', 'Digestive_system_diseases', 'General_pathological_conditions', 'Neoplasms', 'Nervous_system_diseases']
2026-02-20 04:51:04.531 | INFO     | __main__:main:1112 -   Building TF-IDF features...
2026-02-20 04:51:04.684 | DEBUG    | __main__:build_tfidf_features:203 - TF-IDF shape: (500, 1000)
2026-02-20 04:51:04.685 | INFO     | __main__:main:1115 -   Building sentence embeddings...
2026-02-20 04:51:27.746 | DEBUG    | __main__:main:1117 -   Embeddings shape: (500, 384)
2026-02-20 04:51:27.746 | INFO     | __main__:main:1142 -   Building char n-gram features (fallback for LLM)...
2026-02-20 04:51:36.591 | DEBUG    | __main__:build_doc2vec_features:384 - Char n-gram features shape: (500, 100)
2026-02-20 04:51:36.592 | INFO     | __main__:main:1166 -   Working subset size: 500
2026-02-20 04:51:36.592 | INFO     | __main__:main:1171 -   Computing CRND scores...
2026-02-20 04:51:36.767 | INFO     | __main__:main:1174 -   Computing label entropy (kDN per space)...
2026-02-20 04:51:36.938 | INFO     | __main__:main:1180 -   Computing cleanlab scores...
2026-02-20 04:51:56.679 | INFO     | __main__:main:1185 -   Computing WANN-adapted scores...
2026-02-20 04:51:56.724 | INFO     | __main__:main:1188 -   Computing cartography proxy scores...
2026-02-20 04:53:34.318 | INFO     | __main__:main:1191 -   Computing hybrid scores (H1-H4)...
2026-02-20 04:53:34.318 | INFO     | __main__:main:1197 -   Running noise injection evaluation...
2026-02-20 04:53:34.633 | INFO     | __main__:main:1239 -   Running significance tests...
2026-02-20 04:53:41.476 | INFO     | __main__:main:1257 -   Running quadrant analysis...
2026-02-20 04:53:41.477 | INFO     | __main__:main:1269 -   Computing Schoener's D niche overlap...
2026-02-20 04:53:51.231 | INFO     | __main__:main:1277 -   Per-class CRND analysis...
2026-02-20 04:53:51.234 | INFO     | __main__:main:1283 -   Testing niche overlap → classifier prediction...
2026-02-20 04:54:16.878 | INFO     | __main__:main:1324 -   Building per-instance output...
2026-02-20 04:54:16.883 | INFO     | __main__:main:1391 -   medical_abstracts completed in 192s (500 examples)
2026-02-20 04:54:17.013 | INFO     | __main__:main:1102 - === [2/5] Processing mimic_iv_ed_demo (N=207) ===
2026-02-20 04:54:17.014 | INFO     | __main__:main:1107 -   Classes (4): ['ESI-1', 'ESI-2', 'ESI-3', 'ESI-4']
2026-02-20 04:54:17.014 | INFO     | __main__:main:1112 -   Building TF-IDF features...
2026-02-20 04:54:17.021 | DEBUG    | __main__:build_tfidf_features:203 - TF-IDF shape: (207, 414)
2026-02-20 04:54:17.021 | INFO     | __main__:main:1115 -   Building sentence embeddings...
2026-02-20 04:54:19.489 | DEBUG    | __main__:main:1117 -   Embeddings shape: (207, 384)
2026-02-20 04:54:19.489 | INFO     | __main__:main:1142 -   Building char n-gram features (fallback for LLM)...
2026-02-20 04:54:23.058 | DEBUG    | __main__:build_doc2vec_features:384 - Char n-gram features shape: (207, 100)
2026-02-20 04:54:23.058 | INFO     | __main__:main:1166 -   Working subset size: 207
2026-02-20 04:54:23.058 | INFO     | __main__:main:1171 -   Computing CRND scores...
2026-02-20 04:54:23.276 | INFO     | __main__:main:1174 -   Computing label entropy (kDN per space)...
2026-02-20 04:54:23.405 | INFO     | __main__:main:1180 -   Computing cleanlab scores...
2026-02-20 04:54:24.556 | INFO     | __main__:main:1185 -   Computing WANN-adapted scores...
2026-02-20 04:54:24.591 | INFO     | __main__:main:1188 -   Computing cartography proxy scores...
2026-02-20 04:54:26.205 | INFO     | __main__:main:1191 -   Computing hybrid scores (H1-H4)...
2026-02-20 04:54:26.206 | INFO     | __main__:main:1197 -   Running noise injection evaluation...
2026-02-20 04:54:26.470 | INFO     | __main__:main:1239 -   Running significance tests...
2026-02-20 04:54:33.350 | INFO     | __main__:main:1257 -   Running quadrant analysis...
2026-02-20 04:54:33.350 | INFO     | __main__:main:1269 -   Computing Schoener's D niche overlap...
2026-02-20 04:54:41.007 | INFO     | __main__:main:1277 -   Per-class CRND analysis...
2026-02-20 04:54:41.009 | INFO     | __main__:main:1283 -   Testing niche overlap → classifier prediction...
2026-02-20 04:54:41.518 | INFO     | __main__:main:1324 -   Building per-instance output...
2026-02-20 04:54:41.521 | INFO     | __main__:main:1391 -   mimic_iv_ed_demo completed in 25s (207 examples)
2026-02-20 04:54:41.637 | INFO     | __main__:main:1102 - === [3/5] Processing ohsumed_single (N=500) ===
2026-02-20 04:54:41.638 | INFO     | __main__:main:1107 -   Classes (23): ['Animal_Diseases', 'Bacterial_Infections_and_Mycoses', 'Cardiovascular_Diseases', 'Digestive_System_Diseases', 'Disorders_of_Environmental_Origin', 'Endocrine_Diseases', 'Eye_Diseases', 'Female_Genital_Diseases_and_Pregnancy_Complications', 'Hemic_and_Lymphatic_Diseases', 'Immunologic_Diseases']
2026-02-20 04:54:41.638 | INFO     | __main__:main:1112 -   Building TF-IDF features...
2026-02-20 04:54:41.791 | DEBUG    | __main__:build_tfidf_features:203 - TF-IDF shape: (500, 1000)
2026-02-20 04:54:41.791 | INFO     | __main__:main:1115 -   Building sentence embeddings...
2026-02-20 04:55:06.109 | DEBUG    | __main__:main:1117 -   Embeddings shape: (500, 384)
2026-02-20 04:55:06.110 | INFO     | __main__:main:1142 -   Building char n-gram features (fallback for LLM)...
2026-02-20 04:55:16.297 | DEBUG    | __main__:build_doc2vec_features:384 - Char n-gram features shape: (500, 100)
2026-02-20 04:55:16.298 | INFO     | __main__:main:1166 -   Working subset size: 500
2026-02-20 04:55:16.298 | INFO     | __main__:main:1171 -   Computing CRND scores...
2026-02-20 04:55:16.464 | INFO     | __main__:main:1174 -   Computing label entropy (kDN per space)...
2026-02-20 04:55:16.676 | INFO     | __main__:main:1180 -   Computing cleanlab scores...
2026-02-20 04:55:38.005 | INFO     | __main__:main:1185 -   Computing WANN-adapted scores...
2026-02-20 04:55:38.082 | INFO     | __main__:main:1188 -   Computing cartography proxy scores...
2026-02-20 04:56:55.333 | INFO     | __main__:main:1191 -   Computing hybrid scores (H1-H4)...
2026-02-20 04:56:55.337 | INFO     | __main__:main:1197 -   Running noise injection evaluation...
2026-02-20 04:56:55.710 | INFO     | __main__:main:1239 -   Running significance tests...
2026-02-20 04:57:03.275 | INFO     | __main__:main:1257 -   Running quadrant analysis...
2026-02-20 04:57:03.276 | INFO     | __main__:main:1269 -   Computing Schoener's D niche overlap...
2026-02-20 04:57:03.615 | INFO     | __main__:compute_niche_overlap_matrix:884 -   Niche overlap: sampling 100/253 pairs
2026-02-20 04:57:13.005 | INFO     | __main__:compute_niche_overlap_matrix:884 -   Niche overlap: sampling 100/253 pairs
2026-02-20 04:57:18.535 | INFO     | __main__:compute_niche_overlap_matrix:884 -   Niche overlap: sampling 100/253 pairs
2026-02-20 04:57:22.489 | INFO     | __main__:main:1277 -   Per-class CRND analysis...
2026-02-20 04:57:22.493 | INFO     | __main__:main:1283 -   Testing niche overlap → classifier prediction...
2026-02-20 04:57:45.409 | INFO     | __main__:main:1324 -   Building per-instance output...
2026-02-20 04:57:45.434 | INFO     | __main__:main:1391 -   ohsumed_single completed in 184s (500 examples)
2026-02-20 04:57:45.616 | INFO     | __main__:main:1102 - === [4/5] Processing mental_health_conditions (N=500) ===
2026-02-20 04:57:45.617 | INFO     | __main__:main:1107 -   Classes (7): ['anxiety', 'bipolar', 'depression', 'normal', 'personality disorder', 'stress', 'suicidal']
2026-02-20 04:57:45.617 | INFO     | __main__:main:1112 -   Building TF-IDF features...
2026-02-20 04:57:45.690 | DEBUG    | __main__:build_tfidf_features:203 - TF-IDF shape: (500, 1000)
2026-02-20 04:57:45.690 | INFO     | __main__:main:1115 -   Building sentence embeddings...
2026-02-20 04:57:56.391 | DEBUG    | __main__:main:1117 -   Embeddings shape: (500, 384)
2026-02-20 04:57:56.392 | INFO     | __main__:main:1142 -   Building char n-gram features (fallback for LLM)...
2026-02-20 04:58:03.466 | DEBUG    | __main__:build_doc2vec_features:384 - Char n-gram features shape: (500, 100)
2026-02-20 04:58:03.467 | INFO     | __main__:main:1166 -   Working subset size: 500
2026-02-20 04:58:03.469 | INFO     | __main__:main:1171 -   Computing CRND scores...
2026-02-20 04:58:03.642 | INFO     | __main__:main:1174 -   Computing label entropy (kDN per space)...
2026-02-20 04:58:03.864 | INFO     | __main__:main:1180 -   Computing cleanlab scores...
2026-02-20 04:58:25.541 | INFO     | __main__:main:1185 -   Computing WANN-adapted scores...
2026-02-20 04:58:25.610 | INFO     | __main__:main:1188 -   Computing cartography proxy scores...
2026-02-20 04:59:22.973 | INFO     | __main__:main:1191 -   Computing hybrid scores (H1-H4)...
2026-02-20 04:59:22.977 | INFO     | __main__:main:1197 -   Running noise injection evaluation...
2026-02-20 04:59:23.327 | INFO     | __main__:main:1239 -   Running significance tests...
2026-02-20 04:59:30.327 | INFO     | __main__:main:1257 -   Running quadrant analysis...
2026-02-20 04:59:30.328 | INFO     | __main__:main:1269 -   Computing Schoener's D niche overlap...
2026-02-20 04:59:48.154 | INFO     | __main__:main:1277 -   Per-class CRND analysis...
2026-02-20 04:59:48.156 | INFO     | __main__:main:1283 -   Testing niche overlap → classifier prediction...
2026-02-20 05:00:03.657 | INFO     | __main__:main:1324 -   Building per-instance output...
2026-02-20 05:00:03.666 | INFO     | __main__:main:1391 -   mental_health_conditions completed in 138s (500 examples)
2026-02-20 05:00:03.819 | INFO     | __main__:main:1102 - === [5/5] Processing medical_transcriptions (N=500) ===
2026-02-20 05:00:03.819 | INFO     | __main__:main:1107 -   Classes (5): ['cardiovascular_pulmonary', 'internal_medicine', 'neurology_psychiatry', 'radiology_consults_obgyn', 'surgical']
2026-02-20 05:00:03.820 | INFO     | __main__:main:1112 -   Building TF-IDF features...
2026-02-20 05:00:04.184 | DEBUG    | __main__:build_tfidf_features:203 - TF-IDF shape: (500, 1000)
2026-02-20 05:00:04.184 | INFO     | __main__:main:1115 -   Building sentence embeddings...
2026-02-20 05:00:29.914 | DEBUG    | __main__:main:1117 -   Embeddings shape: (500, 384)
2026-02-20 05:00:29.914 | INFO     | __main__:main:1142 -   Building char n-gram features (fallback for LLM)...
2026-02-20 05:00:40.569 | DEBUG    | __main__:build_doc2vec_features:384 - Char n-gram features shape: (500, 100)
2026-02-20 05:00:40.570 | INFO     | __main__:main:1166 -   Working subset size: 500
2026-02-20 05:00:40.570 | INFO     | __main__:main:1171 -   Computing CRND scores...
2026-02-20 05:00:40.829 | INFO     | __main__:main:1174 -   Computing label entropy (kDN per space)...
2026-02-20 05:00:41.026 | INFO     | __main__:main:1180 -   Computing cleanlab scores...
2026-02-20 05:00:58.176 | INFO     | __main__:main:1185 -   Computing WANN-adapted scores...
2026-02-20 05:00:58.251 | INFO     | __main__:main:1188 -   Computing cartography proxy scores...
2026-02-20 05:02:20.073 | INFO     | __main__:main:1191 -   Computing hybrid scores (H1-H4)...
2026-02-20 05:02:20.074 | INFO     | __main__:main:1197 -   Running noise injection evaluation...
2026-02-20 05:02:20.354 | INFO     | __main__:main:1239 -   Running significance tests...
2026-02-20 05:02:28.408 | INFO     | __main__:main:1257 -   Running quadrant analysis...
2026-02-20 05:02:28.409 | INFO     | __main__:main:1269 -   Computing Schoener's D niche overlap...
2026-02-20 05:02:38.693 | INFO     | __main__:main:1277 -   Per-class CRND analysis...
2026-02-20 05:02:38.695 | INFO     | __main__:main:1283 -   Testing niche overlap → classifier prediction...
2026-02-20 05:02:58.889 | INFO     | __main__:main:1324 -   Building per-instance output...
2026-02-20 05:02:58.893 | INFO     | __main__:main:1391 -   medical_transcriptions completed in 175s (500 examples)
2026-02-20 05:02:59.198 | SUCCESS  | __main__:main:1430 - Saved method_out.json (2207 examples across 5 datasets) in 722s
2026-02-20 05:02:59.199 | INFO     | __main__:main:1434 - LLM calls: 0, cost: $0.000
